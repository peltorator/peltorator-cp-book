<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">


<meta name="author" content="peltorator">



<meta name="description" content="–ß–∞—Å—Ç–æ –≤ –∑–∞–¥–∞—á–∞—Ö –±—ã–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–∫–∞—Ç—å $n! \bmod p$. –û–±—ã—á–Ω–æ –º–æ–¥—É–ª—å ‚Äî —ç—Ç–æ –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ, –∞ $n$ –Ω–µ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–µ, –ø–æ—ç—Ç–æ–º—É –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –∑–∞—Ä–∞–Ω–µ–µ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞—Ç—å –≤—Å–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã. –û–¥–Ω–∞–∫–æ –∏–Ω–æ–≥–¥–∞ –±—ã–≤–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è: $p &lt; n$. –° –ø–µ—Ä–≤–æ–≥–æ –≤–∑–≥–ª—è–¥–∞ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞: –≤ $n!$ –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –≤—Ö–æ–¥–∏—Ç —á–∏—Å–ª–æ $p$, –ø–æ—ç—Ç–æ–º—É $n! \bmod p = 0$. –ù–æ —á–∞—Å—Ç–æ –Ω–∞—Å –Ω–µ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ç–∞–∫–æ–π –æ—Ç–≤–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞–º —á–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∏—Ç—å —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞.">



<link rel="icon" href="/favicon.ico">



<meta name="keywords" content=" hugo  latex  theme ">




<script>
  
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true,
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    }
  };
</script>

<script async defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>



<link rel="stylesheet" type="text/css" href="http://tikzjax.com/v1/fonts.css">
<script src="https://tikzjax.com/v1/tikzjax.js"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


<link rel="canonical" href="https://peltorator.ru/posts/mod_factorial/">




<title>–ü–æ–∏—Å–∫ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–∞ –ø–æ –ø—Ä–æ—Å—Ç–æ–º—É –º–æ–¥—É–ª—é - peltorator</title>



<link media="screen" rel="stylesheet" href='https://peltorator.ru/css/common.css'>
<link media="screen" rel="stylesheet" href='https://peltorator.ru/css/content.css'>
<link media="screen" rel="stylesheet" href='https://peltorator.ru/css/highlight.css'>


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="–ü–æ–∏—Å–∫ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–∞ –ø–æ –ø—Ä–æ—Å—Ç–æ–º—É –º–æ–¥—É–ª—é" />
<meta name="twitter:description" content="–ß–∞—Å—Ç–æ –≤ –∑–∞–¥–∞—á–∞—Ö –±—ã–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–∫–∞—Ç—å $n! \bmod p$. –û–±—ã—á–Ω–æ –º–æ–¥—É–ª—å ‚Äî —ç—Ç–æ –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ, –∞ $n$ –Ω–µ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–µ, –ø–æ—ç—Ç–æ–º—É –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –∑–∞—Ä–∞–Ω–µ–µ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞—Ç—å –≤—Å–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã. –û–¥–Ω–∞–∫–æ –∏–Ω–æ–≥–¥–∞ –±—ã–≤–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è: $p &lt; n$. –° –ø–µ—Ä–≤–æ–≥–æ –≤–∑–≥–ª—è–¥–∞ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞: –≤ $n!$ –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –≤—Ö–æ–¥–∏—Ç —á–∏—Å–ª–æ $p$, –ø–æ—ç—Ç–æ–º—É $n! \bmod p = 0$. –ù–æ —á–∞—Å—Ç–æ –Ω–∞—Å –Ω–µ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ç–∞–∫–æ–π –æ—Ç–≤–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞–º —á–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∏—Ç—å —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞." />


  <link rel="stylesheet" href='https://peltorator.ru/css/single.css'>
</head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1>
    <a href="https://peltorator.ru/">peltorator</a>
  </h1>

  <nav>
    
    <span class="nav-bar-item">
      <a class="link" href="/">–°—Ç–∞—Ç—å–∏</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/about/">–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏</a>
    </span>
    
  </nav>
</header>

    <main id="main" class="post">
      
      
      <div class="content">
        <p>–ß–∞—Å—Ç–æ –≤ –∑–∞–¥–∞—á–∞—Ö –±—ã–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–∫–∞—Ç—å $n! \bmod p$. –û–±—ã—á–Ω–æ –º–æ–¥—É–ª—å ‚Äî —ç—Ç–æ –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ, –∞ $n$ –Ω–µ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–µ, –ø–æ—ç—Ç–æ–º—É –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –∑–∞—Ä–∞–Ω–µ–µ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞—Ç—å –≤—Å–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã. –û–¥–Ω–∞–∫–æ –∏–Ω–æ–≥–¥–∞ –±—ã–≤–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è: $p &lt; n$. –° –ø–µ—Ä–≤–æ–≥–æ –≤–∑–≥–ª—è–¥–∞ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞: –≤ $n!$ –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –≤—Ö–æ–¥–∏—Ç —á–∏—Å–ª–æ $p$, –ø–æ—ç—Ç–æ–º—É $n! \bmod p = 0$. –ù–æ —á–∞—Å—Ç–æ –Ω–∞—Å –Ω–µ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ç–∞–∫–æ–π –æ—Ç–≤–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞–º —á–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∏—Ç—å —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Ç–∏–ø–∞ $\frac{0}{0}$, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Ä–∞–≤–Ω–æ —á–µ–º—É-—Ç–æ –Ω–µ–Ω—É–ª–µ–≤–æ–º—É. –í—Å—Ç–∞–µ—Ç –∑–∞–¥–∞—á–∞: –ø–æ—Å—á–∏—Ç–∞—Ç—å $n! \bmod p$ –±–µ–∑ –≤—Ö–æ–∂–¥–µ–Ω–∏–π $p$ –≤ $n!$ –∏ –æ—Ç–¥–µ–ª—å–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å—Ç–µ–ø–µ–Ω—å –≤—Ö–æ–∂–¥–µ–Ω–∏—è $p$ –≤ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª, —Ç–æ –µ—Å—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å $n!$ –≤ –≤–∏–¥–µ $a \cdot p^k$, –≥–¥–µ $a$ –Ω–µ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ $p$.</p>
<p>–ü—É—Å–∫–∞–π $\left\lfloor \frac{n}{p} \right\rfloor = k$ –∏ $n \bmod p = b$. –¢–æ–≥–¥–∞</p>
<p>$$n! = (1 \cdot 2 \cdot \ldots \cdot (p - 1)) \cdot p \cdot ((p + 1) \cdot (p + 2) \cdot \ldots \cdot (2p - 1)) \cdot (2p) \cdot \ldots \cdot (kp) \cdot ((kp + 1) \cdot \ldots \cdot (kp + b))$$</p>
<p>–ï—Å–ª–∏ –±—Ä–∞—Ç—å —ç—Ç–æ –ø–æ –º–æ–¥—É–ª—é $p$, —Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è</p>
<p>$$(p - 1)! \cdot p \cdot (p - 1)! \cdot (2p) \cdot \ldots \cdot (p - 1)! \cdot (kp) \cdot b! = \left((p - 1)!\right)^k \cdot b! \cdot (k! \cdot p^k)$$</p>
<p>–ü—Ä–∏ —ç—Ç–æ–º $p^k$ –º—ã –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è $p$.</p>
<p>–ü–æ —Ç–µ–æ—Ä–µ–º–µ –í–∏–ª—å—Å–æ–Ω–∞ $(p - 1)! \bmod p = -1$. –¢–∞–∫ —á—Ç–æ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å $(-1)^k \cdot b! \cdot k!$.
–ü—Ä–∏ —ç—Ç–æ–º $b &lt; p$ (—ç—Ç–æ –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ $p$), —Ç–∞–∫ —á—Ç–æ $b!$ –º–æ–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∑–∞ $O(p)$, –ø–æ—Å–ª–µ —á–µ–≥–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ $k!$. –ö–∞–∂–¥—ã–π —Ä–∞–∑ –º—ã –¥–µ–ª–∏–º —á–∏—Å–ª–æ $n$ –Ω–∞ $p$, —Ç–∞–∫ —á—Ç–æ –±—É–¥–µ—Ç –≤—Å–µ–≥–æ $\log_p n = \frac{\log n}{\log p}$ –∏—Ç–µ—Ä–∞—Ü–∏–π. –ê—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ ‚Äî $O(p \log_p n)$. –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –≤—Å–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã –¥–æ $p$ –º–æ–∂–Ω–æ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ, –∏ —Ç–æ–≥–¥–∞ –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ –±—É–¥–µ—Ç $O(\log_p n)$ –Ω–∞ –∑–∞–ø—Ä–æ—Å –∏ $O(p)$ –Ω–∞ –ø—Ä–µ–¥–ø–æ—Å—á–µ—Ç.</p>
<p>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∏–∂–µ:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">int</span> <span class="nf">modFactorial</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">factorial</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">p</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">factorial</span> <span class="o">=</span> <span class="mi">1LL</span> <span class="o">*</span> <span class="n">factorial</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">factorial</span> <span class="o">=</span> <span class="mi">1LL</span> <span class="o">*</span> <span class="n">factorial</span> <span class="o">*</span> <span class="n">i</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">factorial</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –µ—Å–ª–∏ –Ω–∞–º –Ω–∞–¥–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å—Ç–µ–ø–µ–Ω—å –≤—Ö–æ–∂–¥–µ–Ω–∏—è $p$ –≤ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª, —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –µ—â–µ –ø—Ä–æ—â–µ. –î–∞–≤–∞–π—Ç–µ –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ—Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∏—Å–µ–ª, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª—è—Ç—Å—è –Ω–∞ $p$, –Ω–∞ $p^2$, –Ω–∞ $p^3$ –∏ —Ç.–¥. –ò —Ç–æ–≥–¥–∞ –µ—Å–ª–∏ —á–∏—Å–ª–æ –¥–µ–ª–∏—Ç—Å—è —Ä–æ–≤–Ω–æ –Ω–∞ $p^k$, —Ç–æ –º—ã —É—á—Ç–µ–º –µ–≥–æ –∫–∞–∫ —Ä–∞–∑ $k$ —Ä–∞–∑. –ê –µ—Å–ª–∏ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∏—Å–µ–ª, –¥–µ–ª—è—â–∏—Ö—Å—è –Ω–∞ $p^i$, ‚Äî —ç—Ç–æ $\left\lfloor \frac{n}{p^i} \right\rfloor$, —Ç–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Ç–∞–∫–æ–π –Ω–µ–∑–∞—Ç–µ–π–ª–∏–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">int</span> <span class="nf">factorialPower</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">power</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">n</span> <span class="o">/=</span> <span class="n">p</span><span class="p">;</span>
        <span class="n">power</span> <span class="o">+=</span> <span class="n">n</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">power</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>–ê—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ —Ä–∞–≤–Ω–∞ $O(\log_p n)$.</p>

      </div>
      
    </main>
    <footer id="footer">
  <div>
    <span>¬© 2021</span> - <span>2021</span>
  </div>

  <div>
    <span>Powered by </span>
    <a class="link" href="https://gohugo.io/">Hugo</a>
    <span> üç¶ Theme </span>
    <a class="link" href="https://github.com/queensferryme/hugo-theme-texify">TeXify</a>
  </div>

  <div class="footnote">
    <span></span>
  </div>
</footer>

  </div>
  





</body>

</html>
