<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">


<meta name="author" content="peltorator">



<meta name="description" content="–ß–∞—Å—Ç–æ –≤ –∑–∞–¥–∞—á–∞—Ö –Ω–∞ –¥–µ—Ä–µ–≤—å—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–æ–∏—á–Ω—ã–µ –ø–æ–¥—ä–µ–º—ã. –û–Ω–∏ –ø–æ–º–æ–≥–∞—é—Ç –∏—Å–∫–∞—Ç—å LCA (–Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ –æ–±—â–µ–≥–æ –ø—Ä–µ–¥–∫–∞), –∫–∞–∫—É—é-—Ç–æ —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞ –ø—É—Ç–∏ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –û–¥–Ω–∞–∫–æ –æ–Ω–∏ –∑–∞–Ω–∏–º–∞—é—Ç $O(n \log n)$ –ø–∞–º—è—Ç–∏. –í —ç—Ç–æ–π –≥–ª–∞–≤–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–æ —Å—Ö–æ–∂–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é, –∑–∞–Ω–∏–º–∞—é—â—É—é –ª–∏–Ω–µ–π–Ω—É—é –ø–∞–º—è—Ç—å.
–ò–¥–µ—è –í –¥–≤–æ–∏—á–Ω—ã—Ö –ø–æ–¥—ä–µ–º–∞—Ö –º—ã –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã —Ö—Ä–∞–Ω–∏–º –ø—Ä–µ–¥–∫–æ–≤ –Ω–∞ $1$, $2$, $4$, $\ldots$, $2^k$ –≤–≤–µ—Ä—Ö. –ß—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ª–∏–Ω–µ–π–Ω–æ–π, –º—ã –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –¥–≤—É—Ö –ø—Ä–µ–¥–∫–æ–≤: –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç—Ü–∞ parent) –∏ –µ—â–µ –∫–∞–∫–æ–≥–æ-—Ç–æ –æ–¥–Ω–æ–≥–æ –ø—Ä–µ–¥–∫–∞ (jump).">



<link rel="icon" href="/favicon.ico">



<meta name="keywords" content=" hugo  latex  theme ">




<script>
  
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true,
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    }
  };
</script>

<script async defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>



<script src="https://tikzjax.com/v1/tikzjax.js"></script>
<script src="https://tikzwolke.com/v1/tikzwolke.js"></script>


<link rel="canonical" href="https://peltorator.ru/try_web/post/linear_binups/">




<title>–î–≤–æ–∏—á–Ω—ã–µ –ø–æ–¥—ä–µ–º—ã —Å –ª–∏–Ω–µ–π–Ω–æ–π –ø–∞–º—è—Ç—å—é - peltorator</title>



<link media="screen" rel="stylesheet" href='https://peltorator.ru/try_web/css/common.css'>
<link media="screen" rel="stylesheet" href='https://peltorator.ru/try_web/css/content.css'>
<link media="screen" rel="stylesheet" href='https://peltorator.ru/try_web/css/highlight.css'>


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="–î–≤–æ–∏—á–Ω—ã–µ –ø–æ–¥—ä–µ–º—ã —Å –ª–∏–Ω–µ–π–Ω–æ–π –ø–∞–º—è—Ç—å—é" />
<meta name="twitter:description" content="–ß–∞—Å—Ç–æ –≤ –∑–∞–¥–∞—á–∞—Ö –Ω–∞ –¥–µ—Ä–µ–≤—å—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–æ–∏—á–Ω—ã–µ –ø–æ–¥—ä–µ–º—ã. –û–Ω–∏ –ø–æ–º–æ–≥–∞—é—Ç –∏—Å–∫–∞—Ç—å LCA (–Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ –æ–±—â–µ–≥–æ –ø—Ä–µ–¥–∫–∞), –∫–∞–∫—É—é-—Ç–æ —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞ –ø—É—Ç–∏ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –û–¥–Ω–∞–∫–æ –æ–Ω–∏ –∑–∞–Ω–∏–º–∞—é—Ç $O(n \log n)$ –ø–∞–º—è—Ç–∏. –í —ç—Ç–æ–π –≥–ª–∞–≤–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–æ —Å—Ö–æ–∂–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é, –∑–∞–Ω–∏–º–∞—é—â—É—é –ª–∏–Ω–µ–π–Ω—É—é –ø–∞–º—è—Ç—å.
–ò–¥–µ—è –í –¥–≤–æ–∏—á–Ω—ã—Ö –ø–æ–¥—ä–µ–º–∞—Ö –º—ã –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã —Ö—Ä–∞–Ω–∏–º –ø—Ä–µ–¥–∫–æ–≤ –Ω–∞ $1$, $2$, $4$, $\ldots$, $2^k$ –≤–≤–µ—Ä—Ö. –ß—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ª–∏–Ω–µ–π–Ω–æ–π, –º—ã –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –¥–≤—É—Ö –ø—Ä–µ–¥–∫–æ–≤: –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç—Ü–∞ parent) –∏ –µ—â–µ –∫–∞–∫–æ–≥–æ-—Ç–æ –æ–¥–Ω–æ–≥–æ –ø—Ä–µ–¥–∫–∞ (jump)." />


  <link rel="stylesheet" href='https://peltorator.ru/try_web/css/single.css'>
</head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1>
    <a href="https://peltorator.ru/try_web/">peltorator</a>
  </h1>

  <nav>
    
  </nav>
</header>

    <main id="main" class="post">
      
      
      
      <h1>–î–≤–æ–∏—á–Ω—ã–µ –ø–æ–¥—ä–µ–º—ã —Å –ª–∏–Ω–µ–π–Ω–æ–π –ø–∞–º—è—Ç—å—é</h1>
      
      <div class="content">
        
        <p>–ß–∞—Å—Ç–æ –≤ –∑–∞–¥–∞—á–∞—Ö –Ω–∞ –¥–µ—Ä–µ–≤—å—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è <a href="https://e-maxx.ru/algo/lca_simpler">–¥–≤–æ–∏—á–Ω—ã–µ –ø–æ–¥—ä–µ–º—ã</a>. –û–Ω–∏ –ø–æ–º–æ–≥–∞—é—Ç –∏—Å–∫–∞—Ç—å LCA (–Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ –æ–±—â–µ–≥–æ –ø—Ä–µ–¥–∫–∞), –∫–∞–∫—É—é-—Ç–æ —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞ –ø—É—Ç–∏ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –û–¥–Ω–∞–∫–æ –æ–Ω–∏ –∑–∞–Ω–∏–º–∞—é—Ç $O(n \log n)$ –ø–∞–º—è—Ç–∏. –í —ç—Ç–æ–π –≥–ª–∞–≤–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–æ —Å—Ö–æ–∂–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é, –∑–∞–Ω–∏–º–∞—é—â—É—é –ª–∏–Ω–µ–π–Ω—É—é –ø–∞–º—è—Ç—å.</p>
<h2 id="–∏–¥–µ—è">–ò–¥–µ—è</h2>
<p>–í –¥–≤–æ–∏—á–Ω—ã—Ö –ø–æ–¥—ä–µ–º–∞—Ö –º—ã –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã —Ö—Ä–∞–Ω–∏–º –ø—Ä–µ–¥–∫–æ–≤ –Ω–∞ $1$, $2$, $4$, $\ldots$, $2^k$ –≤–≤–µ—Ä—Ö. –ß—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ª–∏–Ω–µ–π–Ω–æ–π, –º—ã –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –¥–≤—É—Ö –ø—Ä–µ–¥–∫–æ–≤: –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç—Ü–∞ <code>parent</code>) –∏ –µ—â–µ –∫–∞–∫–æ–≥–æ-—Ç–æ –æ–¥–Ω–æ–≥–æ –ø—Ä–µ–¥–∫–∞ (<code>jump</code>). –ò —Ç–æ–≥–¥–∞ –µ—Å–ª–∏ –º—ã –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã –µ—â–µ —Å–æ—Ö—Ä–∞–Ω–∏–º –µ–µ –≥–ª—É–±–∏–Ω—É (<code>depth</code>), —Ç–æ –º—ã —Å–º–æ–∂–µ–º –ª–µ–≥–∫–æ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã. –ö –ø—Ä–∏–º–µ—Ä—É, –µ—Å–ª–∏ –Ω–∞–º –Ω–∞–¥–æ –Ω–∞–π—Ç–∏ –ø—Ä–µ–¥–∫–∞ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—à–∏–Ω—ã –Ω–∞ –∫–∞–∫–æ–π-—Ç–æ –≥–ª—É–±–∏–Ω–µ, —Ç–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –º—ã —Å—Ç–æ–∏–º –≤ –≤–µ—Ä—à–∏–Ω–µ, –º—ã –±—É–¥–µ–º —Å–Ω–∞—á–∞–ª–∞ —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω—ã–π –ø—Ä—ã–∂–æ–∫, –µ—Å–ª–∏ –æ–Ω –Ω–µ –≤—ã—à–µ –Ω—É–∂–Ω–æ–π –Ω–∞–º –≤–µ—Ä—à–∏–Ω—ã, –±—É–¥–µ–º —Å–æ–≤–µ—Ä—à–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä—ã–∂–æ–∫, –∞ –µ—Å–ª–∏ –∂–µ –æ–Ω –≤—Å–µ —Ç–∞–∫–∏ –≤—ã—à–µ, —Ç–æ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤ –æ—Ç—Ü–∞. –¢–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –º—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–∏–¥–µ–º –≤ –Ω—É–∂–Ω—É—é –≤–µ—Ä—à–∏–Ω—É, –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ç–∞–∫–∏–µ –ø—Ä—ã–∂–∫–∏, —á—Ç–æ–±—ã —ç—Ç–æ—Ç –ø—É—Ç—å –∑–∞–Ω–∏–º–∞–ª –≤—Å–µ–≥–¥–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤.</p>
<p>–ü—Ä–∏ —ç—Ç–æ–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—É–¥–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è, —Ç–∞–∫ –∂–µ –∫–∞–∫ –∏ –æ–±—ã—á–Ω—ã–µ –¥–≤–æ–∏—á–Ω—ã–µ –ø–æ–¥—ä–µ–º—ã. –¢–æ –µ—Å—Ç—å –º—ã –º–æ–∂–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –≤–µ—Ä—à–∏–Ω—ã –≤ –¥–µ—Ä–µ–≤–æ –ø–æ –æ—á–µ—Ä–µ–¥–∏, –∏ —Å—Ç–∞—Ä—ã–µ –ø—Ä—ã–∂–∫–∏ –Ω–µ –±—É–¥—É—Ç –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è.</p>
<p>–û—Å—Ç–∞–µ—Ç—Å—è –ª–∏—à—å –ø—Ä–∏–¥—É–º–∞—Ç—å, –∫–∞–∫ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä—ã–∂–∫–∏. –î–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º —ç—Ç–æ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: –µ—Å–ª–∏ –ø—Ä—ã–∂–æ–∫ –∏–∑ –Ω–∞—à–µ–≥–æ –æ—Ç—Ü–∞ (<code>par</code>) –∏–º–µ–µ—Ç —Ç–∞–∫—É—é –∂–µ –¥–ª–∏–Ω—É, –∫–∞–∫ –∏ –ø—Ä—ã–∂–æ–∫ –∏–∑ –ø—Ä—ã–∂–∫–∞ –Ω–∞—à–µ–≥–æ –æ—Ç—Ü–∞ (<code>jump[par]</code>), —Ç–æ –º—ã –ø—Ä–æ–≤–µ–¥–µ–º —Ä–µ–±—Ä–æ –≤ –ø—Ä—ã–∂–æ–∫ –ø—Ä—ã–∂–∫–∞ –Ω–∞—à–µ–≥–æ –æ—Ç—Ü–∞ (<code>jump[jump[par]]</code>), –∞ –∏–Ω–∞—á–µ –ø—Ä–æ–≤–µ–¥–µ–º —Ä–µ–±—Ä–æ –ø—Ä–æ—Å—Ç–æ –≤ –Ω–∞—à–µ–≥–æ –æ—Ç—Ü–∞. –ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Ç–∞–ª–∏—Å—å, —Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –æ—Å–æ–∑–Ω–∞—Ç—å –∫–æ–¥:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="nf">addLeaf</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">par</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">parent</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">par</span><span class="p">;</span>
    <span class="n">depth</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">depth</span><span class="p">[</span><span class="n">par</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">depth</span><span class="p">[</span><span class="n">par</span><span class="p">]</span> <span class="o">-</span> <span class="n">depth</span><span class="p">[</span><span class="n">jump</span><span class="p">[</span><span class="n">par</span><span class="p">]]</span> <span class="o">==</span> <span class="n">depth</span><span class="p">[</span><span class="n">jump</span><span class="p">[</span><span class="n">par</span><span class="p">]]</span> <span class="o">-</span> <span class="n">depth</span><span class="p">[</span><span class="n">jump</span><span class="p">[</span><span class="n">jump</span><span class="p">[</span><span class="n">par</span><span class="p">]]])</span> <span class="p">{</span>
        <span class="n">jump</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">jump</span><span class="p">[</span><span class="n">jump</span><span class="p">[</span><span class="n">par</span><span class="p">]];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">jump</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">par</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id="–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ">–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ</h2>
<p>–ü–æ—á–µ–º—É –∂–µ —Å —Ç–∞–∫–∏–º–∏ –ø—Ä—ã–∂–∫–∞–º–∏ –Ω–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è —Å–æ–≤–µ—Ä—à–∏—Ç—å –ª–∏—à—å –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤? –î–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–æ–ª–µ–∑–Ω–æ –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –Ω–∞ –¥–ª–∏–Ω—É –ø—Ä—ã–∂–∫–∞ –∏–∑ –≤–µ—Ä—à–∏–Ω—ã $v$ (–∞ —Ç–∞–∫–∂–µ –¥–ª–∏–Ω—ã –ø—Ä—ã–∂–∫–æ–≤ –∏–∑ –≤—Å–µ—Ö –µ–µ –ø—Ä–µ–¥–∫–æ–≤) –≤–ª–∏—è–µ—Ç —Ç–æ–ª—å–∫–æ –µ–µ –≥–ª—É–±–∏–Ω–∞, –Ω–æ –Ω–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ—Ä–µ–≤–∞. –ü–æ—ç—Ç–æ–º—É –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ª–∏—à—å —Å–∏—Ç—É–∞—Ü–∏—é, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—à–µ –¥–µ—Ä–µ–≤–æ —è–≤–ª—è–µ—Ç—Å—è –±–∞–º–±—É–∫–æ–º. –î–∞–≤–∞–π—Ç–µ –∑–∞–º–µ—Ç–∏–º, —á—Ç–æ –¥–ª–∏–Ω–∞ –ª—é–±–æ–≥–æ –ø—Ä—ã–∂–∫–∞ —Ä–∞–≤–Ω–∞ —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏ (–µ—Å–ª–∏ —Å—á–∏—Ç–∞—Ç—å –¥–ª–∏–Ω—É –Ω–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ä–µ–±–µ—Ä, –∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≤–µ—Ä—à–∏–Ω). –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –¥–ª—è –ø—Ä—ã–∂–∫–∞ –≤ –æ—Ç—Ü–∞ –¥–ª–∏–Ω–∞ —Ä–∞–≤–Ω–∞ $2$, –∞ –ª—é–±–æ–π –Ω–æ–≤—ã–π –ø—Ä—ã–∂–æ–∫ ‚Äî —ç—Ç–æ –ª–∏–±–æ –ø—Ä—ã–∂–æ–∫ –≤ –æ—Ç—Ü–∞, –ª–∏–±–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –¥–≤—É—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø—Ä—ã–∂–∫–æ–≤. –¢–æ–≥–¥–∞ –µ—Å–ª–∏ —Ç–µ –ø—Ä—ã–∂–∫–∏ –∏–º–µ–ª–∏ –¥–ª–∏–Ω—É, —Ä–∞–≤–Ω—É—é —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏, —Ç–æ –∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Ç–æ–∂–µ.</p>
<p>–û–¥–Ω–∞–∫–æ –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—ã—á–Ω—ã—Ö –¥–≤–æ–∏—á–Ω—ã—Ö –ø–æ–¥—ä–µ–º–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –º—ã –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–º–µ–Ω—å—à–∞–ª–∏ –¥–ª–∏–Ω—É –ø—Ä—ã–∂–∫–∞, –∑–¥–µ—Å—å –≤—Å–µ –Ω–µ–º–Ω–æ–≥–æ —Å–ª–æ–∂–Ω–µ–µ. –°–Ω–∞—á–∞–ª–∞ –¥–ª–∏–Ω–∞ –ø—Ä—ã–∂–∫–∞ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –∞ –ø–æ—Ç–æ–º –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è. –≠—Ç–æ —á–µ–º-—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –≥–æ—Ä–æ–¥–∞–º–∏. –°–Ω–∞—á–∞–ª–∞ –º—ã –µ–¥–µ–º –ø–æ –º–∞–ª–µ–Ω—å–∫–∏–º —É–ª–æ—á–∫–∞–º, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤—ã–µ–∑–∂–∞—è –Ω–∞ –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–µ –ø—Ä–æ—Å–ø–µ–∫—Ç—ã, –≤ –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤ –≤—ã–µ–∑–∂–∞–µ–º –Ω–∞ —à–æ—Å—Å–µ, –∞ –≤ –∫–æ–Ω—Ü–µ –ø—É—Ç–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è: –º—ã —Å—ä–µ–∑–∂–∞–µ–º —Å –º–∞–≥–∏—Å—Ç—Ä–∞–ª–µ–π –Ω–∞ –ø—Ä–æ—Å–ø–µ–∫—Ç—ã, –∞ —Å –ø—Ä–æ—Å–ø–µ–∫—Ç–æ–≤ –Ω–∞ —É–∑–∫–∏–µ —É–ª–æ—á–∫–∏.</p>
<p>–î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–¥–µ–ª–∏–º –Ω–∞—à –ø—É—Ç—å –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏: —Å–Ω–∞—á–∞–ª–∞ –¥–ª–∏–Ω—ã –ø—Ä—ã–∂–∫–æ–≤ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—Ç, –∏ –º—ã –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—ã–∂–æ–∫, –ø–æ—Ç–æ–º –≤ –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –ø—Ä—ã–∂–æ–∫ –≤–µ–¥–µ—Ç –≤ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫—É—é –≤–µ—Ä—à–∏–Ω—É, –ø–æ—ç—Ç–æ–º—É –Ω–∞–º –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –≤ –æ—Ç—Ü–∞, –ø–æ—Å–ª–µ —á–µ–≥–æ –º—ã –±—É–¥–µ–º –∏–Ω–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ—Ö–æ–¥—ã –≤ –æ—Ç—Ü–æ–≤, –∞ –∏–Ω–æ–≥–¥–∞ –ø—Ä—ã–∂–∫–∏, –Ω–æ –¥–ª–∏–Ω—ã –ø—Ä—ã–∂–∫–æ–≤ –±—É–¥—É—Ç –Ω–µ –≤–æ–∑—Ä–∞—Å—Ç–∞—Ç—å.</p>
<p>–î–æ–∫–∞–∂–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π.</p>
<p><strong>–¢–µ–æ—Ä–µ–º–∞:</strong> –ü—Ä—ã–∂–∫–∏ –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è (–Ω–æ –æ–¥–∏–Ω –º–æ–∂–µ—Ç –ª–µ–∂–∞—Ç—å —Å—Ç—Ä–æ–≥–æ –≤–Ω—É—Ç—Ä–∏ –¥—Ä—É–≥–æ–≥–æ).</p>
<p><strong>–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:</strong></p>
<p>–î–æ–∫–∞–∂–µ–º —ç—Ç–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ –∏–Ω–¥—É–∫—Ü–∏–∏. –ü—É—Å—Ç—å —ç—Ç–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–µ—Ä–Ω–æ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–µ–¥–∫–æ–≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—à–∏–Ω—ã, –¥–æ–∫–∞–∂–µ–º –¥–ª—è –ø—Ä—ã–∂–∫–∞ –∏–∑ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—à–∏–Ω—ã.
–ï—Å–ª–∏ –ø—Ä—ã–∂–æ–∫ –≤–µ–¥–µ—Ç –≤ –æ—Ç—Ü–∞, —Ç–æ —Ç–∞–∫–æ–π –ø—Ä—ã–∂–æ–∫, –æ—á–µ–≤–∏–¥–Ω–æ, –Ω–µ –º–æ–∂–µ—Ç –Ω–∏ —Å –∫–µ–º –ø–µ—Ä–µ—Å–µ–∫–∞—Ç—å—Å—è. –ï—Å–ª–∏ –∂–µ –ø—Ä—ã–∂–æ–∫ –≤–µ–¥–µ—Ç –Ω–µ –≤ –æ—Ç—Ü–∞, —Ç–æ –æ–Ω —è–≤–ª—è–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π –¥–≤—É—Ö –ø—Ä—ã–∂–∫–æ–≤. –ï—Å–ª–∏ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä—ã–∂–æ–∫ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç—Å—è —Å –Ω–æ–≤—ã–º –ø—Ä—ã–∂–∫–æ–º, —Ç–æ –æ–Ω –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç—Å—è –∏ —Å –æ–¥–Ω–∏–º –∏–∑ –¥–≤—É—Ö –º–µ–Ω—å—à–∏—Ö –ø—Ä—ã–∂–∫–æ–≤. –ù–æ –¥–ª—è –Ω–∏—Ö –º—ã —É–∂–µ –¥–æ–∫–∞–∑–∞–ª–∏ –ø–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—é –∏–Ω–¥—É–∫—Ü–∏–∏, —á—Ç–æ –æ–Ω–∏ –ø–æ–ø–∞—Ä–Ω–æ –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è.</p>
<p><strong>–¢–µ–æ—Ä–µ–º–∞:</strong> –ù–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ –¥–≤—É—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø—Ä—ã–∂–∫–æ–≤ –ø–æ–¥—Ä—è–¥, —Ç–æ –µ—Å—Ç—å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–∞–∫, —á—Ç–æ –¥–ª–∏–Ω—ã –ø—Ä—ã–∂–∫–æ–≤ –∏–∑ <code>v</code>, <code>jump[v]</code> –∏ <code>jump[jump[v]]</code> —Å–æ–≤–ø–∞–¥–∞—é—Ç.</p>
<p><strong>–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:</strong>
–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –±—ã –æ–Ω–∏ –≤—Å–µ —Å–æ–≤–ø–∞–¥–∞–ª–∏, —Ç–æ –ø—Ä—ã–∂–æ–∫ –∏–∑ —Å—ã–Ω–∞ <code>jump[v]</code> –≤–µ–ª –±—ã –≤ <code>jump[jump[v]]</code>, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä—ã–∂–∫–∏ –µ–≥–æ –ø—Ä–µ–¥–∫–æ–≤ —Ä–∞–≤–Ω—ã –ø–æ –¥–ª–∏–Ω–µ. –ê —Ç–æ–≥–¥–∞ —ç—Ç–æ—Ç –ø—Ä—ã–∂–æ–∫ –±—ã –ø–µ—Ä–µ—Å–µ–∫–∞–ª—Å—è —Å –ø—Ä—ã–∂–∫–æ–º –∏–∑ $v$, —á—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ç–µ–æ—Ä–µ–º–µ.</p>
<p>–ö—Ä–∞–π–Ω–∏–º —Å–ª—É—á–∞–µ–º –±—É–¥–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—è, –∫–æ–≥–¥–∞ –¥–ª–∏–Ω—ã –≤—Å–µ—Ö —Ç—Ä–µ—Ö –ø—Ä—ã–∂–∫–æ–≤ —Ä–∞–≤–Ω—ã –µ–¥–∏–Ω–∏—Ü–µ, –æ–¥–Ω–∞–∫–æ –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –∏–∑ <code>v</code> –ø—Ä—ã–∂–æ–∫ –¥–æ–ª–∂–µ–Ω –≤–µ—Å—Ç–∏ –≤ <code>jump[jump[v]]</code>, –∞ –Ω–µ –≤ <code>jump[v]</code>, —á—Ç–æ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç —É—Å–ª–æ–≤–∏—é.</p>
<p><strong>–¢–µ–æ—Ä–µ–º–∞:</strong> –î–ª–∏–Ω–∞ –ø—Ä—ã–∂–∫–∞ –∏–∑ <code>v</code> –Ω–µ –±–æ–ª—å—à–µ –¥–ª–∏–Ω—ã –ø—Ä—ã–∂–∫–∞ –∏–∑ <code>jump[v]</code> –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ <code>jump[v]</code> ‚Äî —ç—Ç–æ –Ω–µ –∫–æ—Ä–µ–Ω—å. –¢–æ –µ—Å—Ç—å –µ—Å–ª–∏ –º—ã –ø–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ –ø—Ä—ã–∂–∫–∞–º, —Ç–æ –∏—Ö –¥–ª–∏–Ω—ã –Ω–µ —É–±—ã–≤–∞—é—Ç.</p>
<p><strong>–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:</strong>
–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–∞—à –ø—Ä—ã–∂–æ–∫ –≤–µ–¥–µ—Ç –≤ –∫–æ—Ä–µ–Ω—å, —Ç–æ –æ—Ç—Ç—É–¥–∞ —É–∂–µ –Ω–µ–∫—É–¥–∞ –ø—Ä—ã–≥–∞—Ç—å. –ê –∏–Ω–∞—á–µ –ø—Ä—ã–∂–æ–∫ –±—É–¥–µ—Ç –∏–º–µ—Ç—å –Ω–µ –º–µ–Ω—å—à—É—é –¥–ª–∏–Ω—É.</p>
<p>–î–æ–∫–∞–∂–µ–º —ç—Ç–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ –∏–Ω–¥—É–∫—Ü–∏–∏. –ü—É—Å—Ç—å —ç—Ç–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–µ—Ä–Ω–æ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–µ–¥–∫–æ–≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—à–∏–Ω—ã, –¥–æ–∫–∞–∂–µ–º –¥–ª—è –ø—Ä—ã–∂–∫–∞ –∏–∑ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—à–∏–Ω—ã.
–ï—Å–ª–∏ —ç—Ç–æ—Ç –ø—Ä—ã–∂–æ–∫ –≤–µ–¥–µ—Ç –≤ –æ—Ç—Ü–∞, —Ç–æ —ç—Ç–æ —Å–∞–º—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π –≤–æ–∑–º–æ–∂–Ω—ã–π –ø—Ä—ã–∂–æ–∫, –∏ —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ—á–Ω–æ –Ω–µ –º–µ–Ω—å—à–µ.
–ï—Å–ª–∏ –∂–µ –ø—Ä—ã–∂–æ–∫ –≤–µ–¥–µ—Ç –Ω–µ –≤ –æ—Ç—Ü–∞, —Ç–æ –æ–Ω –±—ã–ª –ø–æ–ª—É—á–µ–Ω –∏–∑ –¥–≤—É—Ö –º–µ–Ω—å—à–∏—Ö –ø—Ä—ã–∂–∫–æ–≤ –¥–ª–∏–Ω—ã –≤ –¥–≤–∞ —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ, –¢–æ–≥–¥–∞ —Ç–∞–∫ –∫–∞–∫ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–µ–¥–∫–æ–≤ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–∂–µ –≤–µ—Ä–Ω–æ, —Ç–æ –ø—Ä—ã–∂–æ–∫ –∏–∑ –Ω–∞—à–µ–≥–æ –ø—Ä—ã–∂–∫–∞ —Ç–æ—á–Ω–æ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–æ—Ä–æ—á–µ –Ω–∞—à–µ–≥–æ –ø—Ä—ã–∂–∫–∞ –±–æ–ª–µ–µ, —á–µ–º –≤ –¥–≤–∞ —Ä–∞–∑–∞. –û–¥–Ω–∞–∫–æ –µ—Å–ª–∏ –æ–Ω –∫–æ—Ä–æ—á–µ —Ä–æ–≤–Ω–æ –≤ –¥–≤–∞ —Ä–∞–∑–∞, —Ç–æ –º—ã –ø–æ–ª—É—á–∞–µ–º —Ç—Ä–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä—ã–∂–∫–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã, —á–µ–≥–æ –Ω–µ –±—ã–≤–∞–µ—Ç –ø–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ç–µ–æ—Ä–µ–º–µ. –ü–æ—ç—Ç–æ–º—É –ø—Ä—ã–∂–æ–∫ –∏–∑ –Ω–∞—à–µ–≥–æ –ø—Ä—ã–∂–∫–∞ –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º —Ç–µ–∫—É—â–∏–π –ø—Ä—ã–∂–æ–∫.</p>
<p>–ò–∑ —ç—Ç–∏—Ö —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –ª–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –ø–µ—Ä–≤–∞—è —Ñ–∞–∑–∞ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è, –≤ –∫–æ—Ç–æ—Ä–æ–π –º—ã –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ –ø—Ä—ã–∂–∫–∞–º, —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –¥–ª–∏–Ω–∞ –ø—Ä—ã–∂–∫–∞ –Ω–µ —É–±—ã–≤–∞–µ—Ç, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –æ–Ω–∞ –Ω–µ –º–æ–∂–µ—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –±–æ–ª–µ–µ, —á–µ–º –¥–≤–∞ —Ä–∞–∑–∞, –ø–æ—ç—Ç–æ–º—É —á–µ—Ä–µ–∑ $2 \log n$ –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª–∏–Ω–∞ –ø—Ä—ã–∂–∫–∞ —Å—Ç–∞–Ω–µ—Ç –Ω–µ –º–µ–Ω—å—à–µ $n$, –∏ –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –ø—Ä—ã–∂–æ–∫ —É–∂–µ —Ç–æ—á–Ω–æ –±—É–¥–µ—Ç –≤—ã—à–µ, —á–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –Ω–∞–º –≤–µ—Ä—à–∏–Ω–∞.</p>
<p>–ù–∞ –≤—Ç–æ—Ä–æ–π –∂–µ —Ñ–∞–∑–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –º—ã –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω—É—é –≤–µ—Ä—à–∏–Ω—É, –≤ –∫–æ—Ç–æ—Ä—É—é –Ω–∞–º –Ω—É–∂–Ω–æ –ø—Ä–∏–π—Ç–∏. –Ω–∞–º –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø—Ä—ã–∂–æ–∫ –¥–ª–∏–Ω—ã $2^k$, —Ç–æ –µ—Å—Ç—å –Ω–∞—à–∞ –≤–µ—Ä—à–∏–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–µ–∂–¥—É —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—à–∏–Ω–æ–π –∏ –ø—Ä—ã–∂–∫–æ–º –∏–∑ –Ω–µ–µ. –¢–æ–≥–¥–∞ –º—ã –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–∞—à–µ–≥–æ –æ—Ç—Ü–∞, –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —á–µ–≥–æ –æ—Ç—Ä–µ–∑–æ–∫, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º—ã –∏—â–µ–º, –ø–æ–¥–µ–ª–∏–ª—Å—è –Ω–∞ –¥–≤–∞. –ò –µ—Å–ª–∏ –Ω—É–∂–Ω–∞—è –≤–µ—Ä—à–∏–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –≤–µ—Ä—Ö–Ω–µ–π –ø–æ–ª–æ–≤–∏–Ω–µ, —Ç–æ –º—ã —Å–¥–µ–ª–∞–µ–º –ø—Ä—ã–∂–æ–∫ –∏–∑ –Ω–∞—à–µ–≥–æ –æ—Ç—Ü–∞, –∞ –µ—Å–ª–∏ –≤ –Ω–∏–∂–Ω–µ–π, —Ç–æ –Ω–µ —Å–¥–µ–ª–∞–µ–º. –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ, —á–µ—Ä–µ–∑ –∫–∞–∂–¥—ã–µ –¥–≤–∞ —à–∞–≥–∞ –¥–ª–∏–Ω–∞ –ø—Ä—ã–∂–∫–∞ –∏–∑ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—à–∏–Ω—ã –±—É–¥–µ—Ç —É–º–µ–Ω—å—à–∞—Ç—å—Å—è –≤ –¥–≤–∞ —Ä–∞–∑–∞, –∏ —Ç–∞–∫–∏–º –±–∏–Ω–ø–æ–∏—Å–∫–æ–º –º—ã –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø—Ä–∏–¥–µ–º –≤ –Ω—É–∂–Ω—É—é –≤–µ—Ä—à–∏–Ω—É.</p>
<h2 id="–ø–æ–∏—Å–∫-–ø—Ä–µ–¥–∫–∞-–Ω–∞-–≥–ª—É–±–∏–Ω–µ-h">–ü–æ–∏—Å–∫ –ø—Ä–µ–¥–∫–∞ –Ω–∞ –≥–ª—É–±–∏–Ω–µ $h$</h2>
<p>–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –Ω–µ —Å–æ–≤—Å–µ–º –æ—á–µ–≤–∏–¥–Ω–æ, –æ–¥–Ω–∞–∫–æ –µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω—è—Ç—å —ç—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö. –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä –µ–µ —Ä–∞–±–æ—Ç—ã –¥–ª—è –∑–∞–¥–∞—á–∏ LA (level ancestor), —Ç–æ –µ—Å—Ç—å –ø–æ–∏—Å–∫–∞ –ø—Ä–µ–¥–∫–∞ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—à–∏–Ω—ã –Ω–∞ –≥–ª—É–±–∏–Ω–µ $h$. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∏–¥–µ–º –Ω–∞–≤–µ—Ä—Ö, –ø—ã—Ç–∞—è—Å—å –ø–æ–π—Ç–∏ –≤ –ø—Ä—ã–∂–æ–∫ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—à–∏–Ω—ã, –µ—Å–ª–∏ –µ–≥–æ –≥–ª—É–±–∏–Ω–∞ –Ω–µ –º–µ–Ω—å—à–µ $h$, –∞ –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –∏–¥–µ–º –≤ –æ—Ç—Ü–∞.</p>
<p>–° —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –º–æ–∂–Ω–æ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –ø–æ <a href="https://pastebin.com/tyrL8gMQ">—Å—Å—ã–ª–∫–µ</a>.</p>
<p>–ê—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ $q$ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –¥–µ—Ä–µ–≤–µ –∏–∑ $n$ –≤–µ—Ä—à–∏–Ω –±—É–¥–µ—Ç $O(n + q \log n)$.</p>
<h2 id="–ø–æ–∏—Å–∫-–Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ-–æ–±—â–µ–≥–æ-–ø—Ä–µ–¥–∫–∞">–ü–æ–∏—Å–∫ –Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ –æ–±—â–µ–≥–æ –ø—Ä–µ–¥–∫–∞</h2>
<p>–¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –¥—Ä—É–≥—É—é –∑–∞–¥–∞—á—É, –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∫–æ—Ç–æ—Ä–æ–π –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –±–∏–Ω–∞—Ä–Ω—ã–µ –ø–æ–¥—ä–µ–º—ã: LCA (least common ancestor –∏–ª–∏ –Ω–∞–∏–º–µ–Ω—å—à–∏–π –æ–±—â–∏–π –ø—Ä–µ–¥–æ–∫). –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è —Å–ª–µ–¥—É—é—â–µ–π –∏–¥–µ–µ–π: —Å–Ω–∞—á–∞–ª–∞ –∏–∑ –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–π –≤–µ—Ä—à–∏–Ω—ã –ø–µ—Ä–µ–π–¥–µ–º –Ω–∞ –≥–ª—É–±–∏–Ω—É –º–µ–Ω–µ–µ –≥–ª—É–±–æ–∫–æ–π –ø—Ä–∏ –ø–æ–º–æ—â–∏ LA, –∞ –∑–∞—Ç–µ–º –±—É–¥–µ–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ø–æ–¥–Ω–∏–º–∞—Ç—å—Å—è –Ω–∞–≤–µ—Ä—Ö –∏–∑ –¥–≤—É—Ö –≤–µ—Ä—à–∏–Ω. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ, —á—Ç–æ –µ—Å–ª–∏ –¥–≤–µ –≤–µ—Ä—à–∏–Ω—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –≥–ª—É–±–∏–Ω–µ, —Ç–æ –¥–ª–∏–Ω—ã –∏—Ö –ø—Ä—ã–∂–∫–æ–≤ —Å–æ–≤–ø–∞–¥–∞—é—Ç, –ø–æ—ç—Ç–æ–º—É –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –ø–æ –ø—Ä—ã–∂–∫—É –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –∫–æ–Ω—Ü—ã —ç—Ç–∏—Ö –ø—Ä—ã–∂–∫–æ–≤ –Ω–µ —Ä–∞–≤–Ω—ã, –∞ –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤ –æ—Ç—Ü–∞.</p>
<p>–° —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –º–æ–∂–Ω–æ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –ø–æ <a href="https://pastebin.com/shHVMMBQ">—Å—Å—ã–ª–∫–µ</a>.</p>
<p>–ê—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ $q$ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –¥–µ—Ä–µ–≤–µ –∏–∑ $n$ –≤–µ—Ä—à–∏–Ω –±—É–¥–µ—Ç $O(n + q \log n)$.</p>
<p>–¢–∞–∫–∂–µ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–≤–æ–∏—á–Ω—ã–º –ø–æ–¥—ä–µ–º–∞–º –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∫–æ–π-—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –ø—Ä—ã–∂–∫–µ –∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ —ç—Ç–æ–≥–æ –∏—Å–∫–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –ø—É—Ç–∏ –≤ –¥–µ—Ä–µ–≤–µ.</p>
<h2 id="–∑–∞–¥–∞—á–∏-–¥–ª—è-–ø—Ä–∞–∫—Ç–∏–∫–∏">–ó–∞–¥–∞—á–∏ –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
<p>–î–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø–æ–¥–æ–π–¥—É—Ç –ª—é–±—ã–µ –∑–∞–¥–∞—á–∏ –Ω–∞ –¥–≤–æ–∏—á–Ω—ã–µ –ø–æ–¥—ä–µ–º—ã –∏ LCA.</p>
<ul>
<li>
<p><a href="https://www.hackerrank.com/challenges/kth-ancestor/problem">–ó–∞–¥–∞—á–∞</a> –Ω–∞ –ø–æ–∏—Å–∫ $k$-–≥–æ –ø—Ä–µ–¥–∫–∞ –≤ –¥–µ—Ä–µ–≤–µ.</p>
</li>
<li>
<p><a href="https://www.spoj.com/problems/LCA/">–ó–∞–¥–∞—á–∞</a> –Ω–∞ –ø–æ–∏—Å–∫ –Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ –æ–±—â–µ–≥–æ –ø—Ä–µ–¥–∫–∞.</p>
</li>
<li>
<p><a href="https://codeforces.com/contest/609/problem/E">–ó–∞–¥–∞—á–∞</a>, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–æ –µ—â–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞–Ω–∏—è –æ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –æ—Å—Ç–æ–≤–Ω—ã—Ö –¥–µ—Ä–µ–≤—å—è—Ö.</p>
</li>
</ul>

        
      </div>
      <div class="paginator">
        
        <a class="link" href="https://peltorator.ru/try_web/post/rmq_offline/">‚Üê prev</a>
        
        
        <a class="link" href="https://peltorator.ru/try_web/post/persistent_cht/">next ‚Üí</a>
        
      </div>
      <div class="comment">
        
        
        
        
      </div>
      
    </main>
    <footer id="footer">
  <div>
    <span>¬© 2021</span> - <span>2021</span>
  </div>

  <div>
    <span>Powered by </span>
    <a class="link" href="https://gohugo.io/">Hugo</a>
    <span> üç¶ Theme </span>
    <a class="link" href="https://github.com/queensferryme/hugo-theme-texify">TeXify</a>
  </div>

  <div class="footnote">
    <span></span>
  </div>
</footer>

  </div>
  





</body>

</html>
