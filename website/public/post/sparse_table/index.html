<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">


<meta name="author" content="peltorator">



<meta name="description" content="Sparse Table –∏–ª–∏ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞ $O(1)$ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –∏ –º–∞–∫—Å–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –≤ –Ω–µ–∏–∑–º–µ–Ω—è—é—â–µ–º—Å—è –º–∞—Å—Å–∏–≤–µ. –ú–∏–Ω—É—Å–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –Ω–∞ –µ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —É—Ö–æ–¥–∏—Ç $O(n \log n)$ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–∞–º—è—Ç–∏.
–ò–¥–µ—è –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —ç—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –∑–∞–¥–∞—á–∏ –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ (RMQ). –î–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–∞–∫—Å–∏–º—É–º–∞ –≤—Å–µ –±—É–¥–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ.
–ò–¥–µ—è —ç—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫—Ä–æ–µ—Ç—Å—è –≤ –µ–µ –Ω–∞–∑–≤–∞–Ω–∏–∏: —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞. –ß—Ç–æ –∂–µ —ç—Ç–æ –∑–∞ —Ç–∞–±–ª–∏—Ü–∞, –∏ –ø–æ—á–µ–º—É –æ–Ω–∞ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è?">



<link rel="icon" href="/favicon.ico">



<meta name="keywords" content=" hugo  latex  theme ">




<script>
  
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true,
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    }
  };
</script>

<script async defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>



<script src="https://tikzjax.com/v1/tikzjax.js"></script>
<script src="https://tikzwolke.com/v1/tikzwolke.js"></script>


<link rel="canonical" href="https://peltorator.ru/try_web/post/sparse_table/">




<title>Sparse Table - peltorator</title>



<link media="screen" rel="stylesheet" href='https://peltorator.ru/try_web/css/common.css'>
<link media="screen" rel="stylesheet" href='https://peltorator.ru/try_web/css/content.css'>
<link media="screen" rel="stylesheet" href='https://peltorator.ru/try_web/css/highlight.css'>


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Sparse Table" />
<meta name="twitter:description" content="Sparse Table –∏–ª–∏ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞ $O(1)$ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –∏ –º–∞–∫—Å–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –≤ –Ω–µ–∏–∑–º–µ–Ω—è—é—â–µ–º—Å—è –º–∞—Å—Å–∏–≤–µ. –ú–∏–Ω—É—Å–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –Ω–∞ –µ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —É—Ö–æ–¥–∏—Ç $O(n \log n)$ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–∞–º—è—Ç–∏.
–ò–¥–µ—è –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —ç—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –∑–∞–¥–∞—á–∏ –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ (RMQ). –î–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–∞–∫—Å–∏–º—É–º–∞ –≤—Å–µ –±—É–¥–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ.
–ò–¥–µ—è —ç—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫—Ä–æ–µ—Ç—Å—è –≤ –µ–µ –Ω–∞–∑–≤–∞–Ω–∏–∏: —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞. –ß—Ç–æ –∂–µ —ç—Ç–æ –∑–∞ —Ç–∞–±–ª–∏—Ü–∞, –∏ –ø–æ—á–µ–º—É –æ–Ω–∞ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è?" />


  <link rel="stylesheet" href='https://peltorator.ru/try_web/css/single.css'>
</head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1>
    <a href="https://peltorator.ru/try_web/">peltorator</a>
  </h1>

  <nav>
    
  </nav>
</header>

    <main id="main" class="post">
      
      
      
      <h1>Sparse Table</h1>
      
      <div class="content">
        
        <p>Sparse Table –∏–ª–∏ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞ $O(1)$ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –∏ –º–∞–∫—Å–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –≤ –Ω–µ–∏–∑–º–µ–Ω—è—é—â–µ–º—Å—è –º–∞—Å—Å–∏–≤–µ. –ú–∏–Ω—É—Å–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –Ω–∞ –µ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —É—Ö–æ–¥–∏—Ç $O(n \log n)$ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–∞–º—è—Ç–∏.</p>
<h2 id="–∏–¥–µ—è">–ò–¥–µ—è</h2>
<p>–î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —ç—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –∑–∞–¥–∞—á–∏ –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ (RMQ). –î–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–∞–∫—Å–∏–º—É–º–∞ –≤—Å–µ –±—É–¥–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ.</p>
<p>–ò–¥–µ—è —ç—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫—Ä–æ–µ—Ç—Å—è –≤ –µ–µ –Ω–∞–∑–≤–∞–Ω–∏–∏: —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞. –ß—Ç–æ –∂–µ —ç—Ç–æ –∑–∞ —Ç–∞–±–ª–∏—Ü–∞, –∏ –ø–æ—á–µ–º—É –æ–Ω–∞ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è? –ü–æ–¥ —Ç–∞–±–ª–∏—Ü–µ–π –∑–¥–µ—Å—å –ø–æ–Ω–∏–º–∞–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω—è—Ç—Å—è –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ. –¢–æ –µ—Å—Ç—å –∫–≤–∞–¥—Ä–∞—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ –æ—Ç–ª–æ–∂–µ–Ω—ã –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ª–µ–≤—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã, –∞ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∞–≤—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã. –ò–º–µ—è —Ç–∞–∫—É—é —Ç–∞–±–ª–∏—Ü—É, –º–æ–∂–Ω–æ –±–µ–∑ —Ç—Ä—É–¥–∞ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –ø—Ä–æ—Å—Ç–æ –æ–±—Ä–∞—â–∞—è—Å—å –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –ø–æ–ª—è–º –Ω–∞—à–µ–π —Ç–∞–±–ª–∏—Ü—ã. –û–¥–Ω–∞–∫–æ —á—Ç–æ–±—ã –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ç–∞–∫—É—é —Ç–∞–±–ª–∏—Ü—É, –Ω—É–∂–Ω–æ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å $O(n^2)$ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–∞–º—è—Ç–∏, —á—Ç–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ.</p>
<p>–í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –º—ã —Ä–µ—à–∞–µ–º, —á—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—é —Ç–∞–±–ª–∏—Ü—É –º—ã –Ω–µ –±—É–¥–µ–º, –∞ –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É. –¢–æ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –¥–ª—è –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤, –∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö. –û–¥–Ω–∞–∫–æ —ç—Ç–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–∞–∫–∏–µ –æ—Ç—Ä–µ–∑–∫–∏, —á—Ç–æ–±—ã –∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –Ω–∏—Ö –º–æ–∂–Ω–æ –±—ã–ª–æ —Å–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç –¥–ª—è –ª—é–±–æ–≥–æ –æ—Ç—Ä–µ–∑–∫–∞. –í –æ–±—ã—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –ª—é–±–æ–π –æ—Ç—Ä–µ–∑–æ–∫ —É–∂–µ –±—ã–ª –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞–Ω. –¢–∞–∫–æ–≥–æ –º—ã —Å–µ–±–µ –ø–æ–∑–≤–æ–ª–∏—Ç—å –Ω–µ –º–æ–∂–µ–º, –Ω–æ –¥–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º –Ω–µ–º–Ω–æ–≥–æ –±–æ–ª–µ–µ —Å–ª–∞–±–æ–µ —É—Å–ª–æ–≤–∏–µ: –¥–æ–ª–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —É—Å–ª–æ–≤–∏–µ, —á—Ç–æ –ª—é–±–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –º–∞—Å—Å–∏–≤–∞ –º–æ–∂–Ω–æ –Ω–∞–∫—Ä—ã—Ç—å –¥–≤—É–º—è –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –æ—Ç—Ä–µ–∑–∫–∞–º–∏. –¢–æ–≥–¥–∞ –º–∏–Ω–∏–º—É–º –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ ‚Äî —ç—Ç–æ –º–∏–Ω–∏–º—É–º –∏–∑ –¥–≤—É—Ö –º–∏–Ω–∏–º—É–º–æ–≤ –Ω–∞ —ç—Ç–∏—Ö –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞—Ö. –ü—Ä–∏ —ç—Ç–æ–º —ç—Ç–∏ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∏ –º–æ–≥—É—Ç –ø–µ—Ä–µ—Å–µ–∫–∞—Ç—å—Å—è. –í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –∫–∞–∫ —Ä–∞–∑ —Ç–∞–∫–∏ –º—ã –∏ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è —Ç–µ–º, —á—Ç–æ –º—ã –∏—â–µ–º –∏–º–µ–Ω–Ω–æ –º–∏–Ω–∏–º—É–º –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ, –∞ –Ω–µ —Å—É–º–º—É. –ï—Å–ª–∏ –±—ã –º—ã –∏—Å–∫–∞–ª–∏ —Å—É–º–º—É, —Ç–æ –Ω–∞–º –±—ã–ª–æ –±—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Ä–∞–∑–±–∏–≤–∞–µ–º –Ω–∞—à –æ—Ç—Ä–µ–∑–æ–∫, –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞–ª–∏—Å—å, –∏–Ω–∞—á–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –º—ã —É—á—Ç–µ–º –¥–≤–∞–∂–¥—ã.</p>
<p>–î–ª—è –º–∏–Ω–∏–º—É–º–∞ —ç—Ç–æ –Ω–µ–ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ: –µ—Å–ª–∏ –º—ã –≤–æ–∑—å–º–µ–º –¥–≤–∞–∂–¥—ã –º–∏–Ω–∏–º—É–º —Å –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ —á–∏—Å–ª–æ–º, —Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –ø–æ–º–µ–Ω—è–µ—Ç—Å—è. –¢–∞–∫–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é. –î—Ä—É–≥–∏–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ —Ç–æ–∂–µ –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü: –º–∞–∫—Å–∏–º—É–º (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–∏–Ω–∏–º—É–º—É), –ù–û–î ($gcd(a, a) = a$, –æ–¥–Ω–∞–∫–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ù–û–î–∞ –¥–≤—É—Ö —á–∏—Å–µ–ª –∑–∞–Ω–∏–º–∞–µ—Ç –Ω–µ–∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–µ –≤—Ä–µ–º—è, –ø–æ—ç—Ç–æ–º—É –ù–û–î –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –º—ã –±—É–¥–µ–º –∏—Å–∫–∞—Ç—å –≤—Å–µ —Ç–∞–∫–∏ –Ω–µ –∑–∞ $O(1)$, –∞ –∑–∞ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –æ–¥–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ $gcd$) –∏ —Ç.–¥.</p>
<p>–ö–∞–∫–∏–µ –∂–µ –æ—Ç—Ä–µ–∑–∫–∏ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ–±—ã –ª—é–±–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑–±–∏–≤–∞–ª—Å—è –Ω–∞ –¥–≤–∞ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –æ—Ç—Ä–µ–∑–∫–∞, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –±—ã–ª–æ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç—ã–≤–∞—Ç—å –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –≤—Å–µ–≥–æ? –î–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞–µ–º –º–∏–Ω–∏–º—É–º –¥–ª—è –≤—Å–µ—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤, –¥–ª–∏–Ω—ã –∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–≤–Ω—ã —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏. –°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ —Ç–∞–∫–∏—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤? –î–ª—è –∫–∞–∂–¥–æ–π –¥–ª–∏–Ω—ã —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ –±–æ–ª–µ–µ $n$ –æ—Ç—Ä–µ–∑–∫–æ–≤ —Ç–∞–∫–æ–π –¥–ª–∏–Ω—ã (–ø—Ä–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω–µ —É –≤—Å–µ—Ö —Ç–∞–∫–∏—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤ —Ä–∞–∑–Ω—ã–µ –ª–µ–≤—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã). –ü—Ä–∏ —ç—Ç–æ–º —Ä–∞–∑–Ω—ã—Ö —Å—Ç–µ–ø–µ–Ω–µ–π –¥–≤–æ–π–∫–∏, –Ω–µ –±–æ–ª—å—à–∏—Ö $n$, –µ—Å—Ç—å $\left\lfloor \log n \right\rfloor$ —à—Ç—É–∫: $1$, $2$, $4$, $\ldots$, $2^{\left\lfloor \log n \right\rfloor}$. –¢–∞–∫ —á—Ç–æ –Ω–∞—à–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—É–¥–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å $O(n \log n)$ –ø–∞–º—è—Ç–∏.</p>
<p>–û —Ç–æ–º, –∫–∞–∫ —ç—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∏ —Ö—Ä–∞–Ω–∏—Ç—å, –º—ã –ø–æ–≥–æ–≤–æ—Ä–∏–º –ø–æ–∑–∂–µ, –∞ –ø–æ–∫–∞ –ø–æ–π–º–µ–º, –ø–æ—á–µ–º—É —Ç–µ–ø–µ—Ä—å –ª—é–±–æ–π –æ—Ç—Ä–µ–∑–æ–∫ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–≤–∞ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞. –ü—É—Å–∫–∞–π –¥–ª–∏–Ω–∞ –æ—Ç—Ä–µ–∑–∫–∞ —Ä–∞–≤–Ω–∞ $len$. –ü—É—Å—Ç—å $2^k$ ‚Äî —ç—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å –¥–≤–æ–π–∫–∏, –Ω–µ –±√≥–ª—å—à–∞—è $len$. –¢–æ–≥–¥–∞ –¥–∞–≤–∞–π—Ç–µ –≤–æ–∑—å–º–µ–º –æ–¥–∏–Ω –ø–æ–¥–æ—Ç—Ä–µ–∑–æ–∫ –¥–ª–∏–Ω—ã $2^k$, –Ω–∞—á–∏–Ω–∞—é—â–∏–π—Å—è –≤ –ª–µ–≤–æ–π –≥—Ä–∞–Ω–∏—Ü–µ –æ—Ç—Ä–µ–∑–∫–∞, –∞ –¥—Ä—É–≥–æ–π ‚Äî –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∏–π—Å—è –≤ –ø—Ä–∞–≤–æ–π –≥—Ä–∞–Ω–∏—Ü–µ. –û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –æ–Ω–∏ –±—É–¥—É—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–µ–∂–∞—Ç—å –≤–Ω—É—Ç—Ä–∏ –æ—Ç—Ä–µ–∑–∫–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ  $2^k \le len$, –æ—Å—Ç–∞–ª–æ—Å—å –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –æ–Ω–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã–≤–∞—é—Ç –æ—Ç—Ä–µ–∑–æ–∫, —Ç–æ –µ—Å—Ç—å –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è, —Ç–æ –≤–Ω—É—Ç—Ä–∏ –æ—Ç—Ä–µ–∑–∫–∞ –¥–ª–∏–Ω—ã $len$ –º–æ–∂–Ω–æ –ø–æ–º–µ—Å—Ç–∏—Ç—å –¥–≤–∞ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –æ—Ç—Ä–µ–∑–∫–∞ –¥–ª–∏–Ω—ã $2^k$, —Ç–æ–≥–¥–∞ –¥–ª–∏–Ω–∞ –æ—Ç—Ä–µ–∑–∫–∞ –Ω–µ –º–µ–Ω—å—à–µ, —á–µ–º $2^k + 2^k = 2^{k + 1}$, –Ω–æ –≤–µ–¥—å –º—ã –≤–∑—è–ª–∏ —á–∏—Å–ª–æ $2^k$ —Ç–∞–∫, —á—Ç–æ–±—ã —ç—Ç–æ –±—ã–ª–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å –¥–≤–æ–π–∫–∏, –Ω–µ –±√≥–ª—å—à–∞—è $len$. –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ.</p>
<h2 id="–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ">–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ</h2>
<p>–¢–µ–ø–µ—Ä—å –ø–æ–≥–æ–≤–æ—Ä–∏–º –ø—Ä–æ —Ç–æ, –∫–∞–∫ –º—ã –±—É–¥–µ–º —Å—Ç—Ä–æ–∏—Ç—å –∏ —Ö—Ä–∞–Ω–∏—Ç—å —ç—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É. –•—Ä–∞–Ω–∏—Ç—å –º—ã –µ–µ –±—É–¥–µ–º –≤ –¥–≤—É–º–µ—Ä–Ω–æ–º –º–∞—Å—Å–∏–≤–µ —Ä–∞–∑–º–µ—Ä–∞ $\log n \times n$. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏ –∏ –¥–ª—è –∫–∞–∂–¥–æ–π –ª–µ–≤–æ–π –≥—Ä–∞–Ω–∏—Ü—ã —Å–æ—Ö—Ä–∞–Ω–∏–º –º–∏–Ω–∏–º—É–º –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º –æ—Ç—Ä–µ–∑–∫–µ. –í–∞–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ, —á—Ç–æ –Ω–µ –¥–ª—è –ª—é–±–æ–π –ª–µ–≤–æ–π –≥—Ä–∞–Ω–∏—Ü—ã –∏ —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –æ—Ç—Ä–µ–∑–æ–∫. –ö –ø—Ä–∏–º–µ—Ä—É, –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –º–∞—Å—Å–∏–≤–∞ –µ—Å—Ç—å –æ—Ç—Ä–µ–∑–æ–∫ —Ç–æ–ª—å–∫–æ –¥–ª–∏–Ω—ã $1$. –£ —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã –µ—Å—Ç—å –¥–≤–∞ —Ä–µ—à–µ–Ω–∏—è: –ø–µ—Ä–≤–æ–µ ‚Äî –ø—Ä–æ—Å—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫–∏–µ –æ—Ç—Ä–µ–∑–∫–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –Ω–∞–º –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è, –≤—Ç–æ—Ä–æ–µ ‚Äî –µ—Å–ª–∏ –æ—Ç—Ä–µ–∑–æ–∫ –≤—ã–ª–µ–∑–∞–µ—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –º–∞—Å—Å–∏–≤–∞, –æ–±—Ä–µ–∑–∞—Ç—å –µ–≥–æ –∫–æ–Ω—Ü–æ–º –º–∞—Å—Å–∏–≤–∞. –ö–æ–Ω–µ—á–Ω–æ, –Ω–µ –¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –ª–µ–≥—á–µ, —á–µ–º –¥–µ–ª–∞—Ç—å, –ø–æ—ç—Ç–æ–º—É –º—ã –≤—ã–±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–∏ –æ—Ç—Ä–µ–∑–∫–∏ –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.</p>
<p>–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –±—ã—Å—Ç—Ä–æ –Ω–∞—Å—á–∏—Ç–∞—Ç—å –Ω–∞—à—É —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏–¥–µ–µ–π, –ø–æ—Ö–æ–∂–µ–π –Ω–∞ –∏–¥–µ—é –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –ª—é–±–æ–º –æ—Ç—Ä–µ–∑–∫–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ–º –µ–≥–æ –Ω–∞ –¥–≤–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –ª—é–±–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –¥–ª–∏–Ω—ã $2^{k}$ ‚Äî —ç—Ç–æ –¥–≤–∞ –æ—Ç—Ä–µ–∑–∫–∞ –¥–ª–∏–Ω—ã $2^{k - 1}$, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –≤–∑—è—Ç—å –º–∏–Ω–∏–º—É–º –∏–∑ –¥–≤—É—Ö –º–∏–Ω–∏–º—É–º–æ–≤. –¢–æ–≥–¥–∞ –µ—Å–ª–∏ –º—ã –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏–º, —á—Ç–æ –º–∏–Ω–∏–º—É–º—ã –Ω–∞ –æ—Ç—Ä–µ–∑–∫–∞—Ö –¥–ª–∏–Ω—ã $1$ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞, –∞ –ø–æ—Ç–æ–º –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å –Ω–∞—à—É —Ç–∞–±–ª–∏—Ü—É –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏, —Ç–æ –∫–∞–∂–¥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ—Å—á–∏—Ç–∞—Ç—å –∑–∞ $O(1)$ –ø–æ —Å–ª–µ–¥—É—é—â–µ–π —Ñ–æ—Ä–º—É–ª–µ:</p>
<p><code>sparseTable[k][ind] = min(sparseTable[k - 1][ind], sparseTable[k - 1][ind + (1 &lt;&lt; (k - 1))])</code></p>
<p>–ù–∞–º –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –º–∏–Ω–∏–º—É–º –Ω–∞ –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª–µ $[ind, ind + 2^k)$, –æ–Ω —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–≤–∞ –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª–∞: $[ind, ind + 2^{k - 1})$ –∏ $[ind + 2^{k - 1}, ind + 2^k)$. –ò –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ, –≤ —ç—Ç–æ–π —Ç–µ–º–µ, –∫–∞–∫ –∏ –≤ –ø–æ—á—Ç–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π, –ª—É—á—à–µ –≤—Å–µ–≥–æ –¥—É–º–∞—Ç—å –≤—Å–µ–≥–¥–∞ –ø—Ä–æ –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª—ã, –∞ –Ω–µ –ø—Ä–æ –æ—Ç—Ä–µ–∑–∫–∏, —á—Ç–æ–±—ã –Ω–µ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è.</p>
<p>–î–∞–≤–∞–π—Ç–µ –ø—Ä–∏–≤–µ–¥–µ–º –ø–æ–ª–Ω—ã–π –∫–æ–¥ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –∑–∞ $O(n \log n)$:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">buildSparseTable</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span> <span class="n">arr</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">arr</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="kt">int</span> <span class="n">maxpow</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">log2</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span> <span class="c1">// 2^{maxpow} &gt; n
</span><span class="c1"></span>    <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">sparse</span><span class="p">(</span><span class="n">maxpow</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
    <span class="n">sparse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">maxpow</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">ind</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ind</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">k</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">ind</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">sparse</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">sparse</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">ind</span><span class="p">],</span> <span class="n">sparse</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">ind</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">k</span><span class="p">)]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">sparse</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>–ó–¥–µ—Å—å –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤—ã–±—Ä–∞–Ω –Ω–µ–º–Ω–æ–≥–æ –∏–Ω–æ–π —Å–ø–æ—Å–æ–± –ø–æ–¥—Å—á–µ—Ç–∞: –º—ã –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–µ $k$-–π —Å–ª–æ–π —á–µ—Ä–µ–∑ $k-1$-–π, –∞ $k+1$-–π —á–µ—Ä–µ–∑ $k$-–π.</p>
<p>–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –¥–ª—è –ø–æ–ª–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –Ω–∞–º–∏ –ø–æ–¥—Ö–æ–¥–∞ —É—Å–ª–æ–≤–∏–µ —Ü–∏–∫–ª–∞ –ø–æ $ind$ –¥–æ–ª–∂–Ω–æ –±—ã–ª–æ –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:</p>
<p><code>ind + (1 &lt;&lt; (k + 1)) &lt;= n</code></p>
<p>–¢–æ –µ—Å—Ç—å –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª $[ind, ind + 2^{k + 1})$ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–µ–∂–∏—Ç –≤ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –º–∞—Å—Å–∏–≤–∞. –û–¥–Ω–∞–∫–æ –º—ã –æ—Å–ª–∞–±–∏–ª–∏ —ç—Ç–æ —É—Å–ª–æ–≤–∏–µ, –ø–æ—Å—á–∏—Ç–∞–≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏—à–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –æ–¥–Ω–∞–∫–æ –º—ã –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç–≤–µ—Ç–µ –Ω–∞ –∑–∞–ø—Ä–æ—Å, –ø–æ—ç—Ç–æ–º—É —ç—Ç–æ –Ω–∏–∫–∞–∫ –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É –Ω–∞—à–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –ù–æ —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –∑–¥–µ—Å—å –Ω–∞–º –Ω–µ –ø—Ä–∏—à–ª–æ—Å—å –¥—É–º–∞—Ç—å –∏ –≤—Å–ø–æ–º–∏–Ω–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ. –í—Å–µ, –æ —á–µ–º –º—ã –±–µ—Å–ø–æ–∫–æ–∏–º—Å—è, ‚Äî —ç—Ç–æ —Ç–æ, —á—Ç–æ–±—ã –∏–Ω–¥–µ–∫—Å—ã –º–∞—Å—Å–∏–≤–∞, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º, –±—ã–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã. –ê —Ç–∞–∫ –∫–∞–∫ –º—ã –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ –∏–Ω–¥–µ–∫—Å—É $ind + 2^k$, –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–µ–Ω—å—à–µ $n$.</p>
<p>$maxpow$ –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –ª—é–±—ã–º —Å–ø–æ—Å–æ–±–æ–º, —á—Ç–æ–±—ã –æ–Ω–æ –±—ã–ª–æ —Å—Ç—Ä–æ–≥–æ –±–æ–ª—å—à–µ $\log n$.</p>
<p><strong>–ó–∞–º–µ—á–∞–Ω–∏–µ:</strong>
–ü–æ—Ä—è–¥–æ–∫ —Ü–∏–∫–ª–æ–≤ –∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π –≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –º–æ–∂–µ—Ç –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ –≤–ª–∏—è—Ç—å –Ω–∞ –≤—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–∑-–∑–∞ —Ä–∞–±–æ—Ç—ã —Å –∫—ç—à–∞–º–∏. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º (–ø—Ä–∏–º–µ—Ä–Ω–æ –≤ 3-5 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ –¥—Ä—É–≥–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤).</p>
<h2 id="–æ—Ç–≤–µ—Ç-–Ω–∞-–∑–∞–ø—Ä–æ—Å">–û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å</h2>
<p>–î–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∑–∞–ø—Ä–æ—Å –Ω–∞–º –Ω–∞–¥–æ –Ω–∞–π—Ç–∏ –±–ª–∏–∂–∞–π—à—É—é –∫ –¥–ª–∏–Ω–µ –æ—Ç—Ä–µ–∑–∫–∞ —Å—Ç–µ–ø–µ–Ω—å –¥–≤–æ–π–∫–∏, –∞ –ø–æ—Ç–æ–º –≤–∑—è—Ç—å –º–∏–Ω–∏–º—É–º –∏–∑ –¥–≤—É—Ö —Ç–∞–∫–∏—Ö –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–æ–≤. –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —ç—Ç–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏—é –ª–æ–≥–∞—Ä–∏—Ñ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏, –ø–æ—ç—Ç–æ–º—É —Å –Ω–µ–π –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –æ—à–∏–±–∏—Ç—å—Å—è –∏–∑-–∑–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏. –ú–æ–∂–Ω–æ –∑–∞—Ä–∞–Ω–µ–µ —Å–æ–∑–¥–∞—Ç—å –º–∞—Å—Å–∏–≤, –≤ –∫–æ—Ç–æ—Ä–æ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∏—Å–ª–∞ –æ—Ç $1$ –¥–æ $n$ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞—Ç—å –¥–≤–æ–∏—á–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –Ω–µ—Å–ª–æ–∂–Ω—ã–º –∫–æ–¥–æ–º:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">logs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">logs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">logs</span><span class="p">[</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, —Ü–µ–ª–∞—è —á–∞—Å—Ç—å –¥–≤–æ–∏—á–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞ ‚Äî —ç—Ç–æ —Ç–æ, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —á–∏—Å–ª–æ –Ω–∞–¥–æ –ø–æ–¥–µ–ª–∏—Ç—å –Ω–∞—Ü–µ–ª–æ –Ω–∞ –¥–≤–∞, —á—Ç–æ–±—ã –æ–Ω–æ —Å—Ç–∞–ª–æ –µ–¥–∏–Ω–∏—Ü–µ–π. –≠—Ç–æ –º–æ–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–∑ —Ç–∞–∫–æ–π –¥–∏–Ω–∞–º–∏–∫–æ–π: –µ—Å–ª–∏ —á–∏—Å–ª—É $\left\lfloor \frac{i}{2} \right\rfloor$ –Ω—É–∂–Ω–æ <code>logs[i &gt;&gt; 1]</code> –¥–µ–π—Å—Ç–≤–∏–π, —Ç–æ —á–∏—Å–ª—É $i$ –Ω—É–∂–Ω–æ –Ω–∞ –æ–¥–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ –±–æ–ª—å—à–µ.</p>
<p>–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏ –≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ $maxpow$ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∫–∞–∫ <code>logs[n] + 1</code>.</p>
<p>–ö–æ–≥–¥–∞ –º—ã –ø–æ—Å—á–∏—Ç–∞–ª–∏ –ª–æ–≥–∞—Ä–∏—Ñ–º—ã, –º—ã –≥–æ—Ç–æ–≤—ã –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª–µ:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">int</span> <span class="nf">findMin</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// [l, r)
</span><span class="c1"></span>    <span class="kt">int</span> <span class="n">power</span> <span class="o">=</span> <span class="n">logs</span><span class="p">[</span><span class="n">r</span> <span class="o">-</span> <span class="n">l</span><span class="p">];</span>
    <span class="k">return</span> <span class="n">min</span><span class="p">(</span><span class="n">sparse</span><span class="p">[</span><span class="n">power</span><span class="p">][</span><span class="n">l</span><span class="p">],</span> <span class="n">sparse</span><span class="p">[</span><span class="n">power</span><span class="p">][</span><span class="n">r</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">power</span><span class="p">)]);</span>
<span class="p">}</span>
</code></pre></div><p>–û—á–µ–≤–∏–¥–Ω–æ, –∑–∞–ø—Ä–æ—Å –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $O(1)$.</p>
<p>–û–¥–∏–Ω –∏–∑ –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Ä–∞–∑–±–∏–≤–∞–µ–º, –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è –≤ –ª–µ–≤–æ–π –≥—Ä–∞–Ω–∏—Ü–µ, –∞ –¥—Ä—É–≥–æ–π –¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –≤ –ø—Ä–∞–≤–æ–π, –ø–æ—ç—Ç–æ–º—É –µ–≥–æ –ª–µ–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞ $2^{power}$ –Ω–∞–∑–∞–¥.</p>
<p>–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –±–ª–∞–≥–æ–¥–∞—Ä—è —Ç–æ–º—É, —á—Ç–æ –º—ã –≤—Å–µ —Å—á–∏—Ç–∞–µ–º –Ω–∞ –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª–∞—Ö, —É –Ω–∞—Å –≤–æ –≤—Å–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–π $\pm 1$.</p>
<p>–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –µ—Å—Ç—å —Ç—Ä—é–∫, –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ C++, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç—ã–≤–∞—Ç—å –ª–æ–≥–∞—Ä–∏—Ñ–º—ã. –ö–æ–Ω–µ—á–Ω–æ, —Ñ—É–Ω–∫—Ü–∏—é <code>log2</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ —Å—Ç–æ–∏—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —á–∏—Å–ª–∞–º–∏ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π, –æ–¥–Ω–∞–∫–æ –µ—Å—Ç—å —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∏—Ç—å –¥–≤–æ–∏—á–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º –≤ —Ü–µ–ª—ã—Ö —á–∏—Å–ª–∞—Ö. –í —ç—Ç–æ–º –Ω–∞–º –ø–æ–º–æ–∂–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è <code>__builtin_clz</code>. <code>builtin</code> –æ–∑–Ω–∞—á–∞–µ—Ç &laquo;–≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è&raquo;, –∞ <code>clz</code> —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ &laquo;count leading zeros&raquo;, —Ç–æ –µ—Å—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ–¥—É—â–∏—Ö –Ω—É–ª–µ–π. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ–¥—É—â–∏—Ö –Ω—É–ª–µ–π –∫–∞–∫ —Ä–∞–∑ —Ç–∞–∫–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∏–Ω–¥–µ–∫—Å–æ–º –ø–µ—Ä–≤–æ–π –µ–¥–∏–Ω–∏—Ü—ã (–≤ —á–∏—Å–ª–µ –∏–¥–µ—Ç $k$ –Ω—É–ª–µ–π, –∞ –ø–æ—Å–ª–µ –Ω–∏—Ö —Å—Ç–æ–∏—Ç –µ–¥–∏–Ω–∏—Ü–∞; —ç—Ç–æ $k$-—è –ø–æ–∑–∏—Ü–∏—è). –ê –∏–Ω–¥–µ–∫—Å —Å—Ç–∞—Ä—à–µ–π –µ–¥–∏–Ω–∏—Ü—ã ‚Äî —ç—Ç–æ –∫–∞–∫ —Ä–∞–∑ —Ç–∞–∫–∏ –ª–æ–≥–∞—Ä–∏—Ñ–º —á–∏—Å–ª–∞. –û–¥–Ω–∞–∫–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –∏–Ω–¥–µ–∫—Å —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã: —Å —Å–∞–º–æ–≥–æ —Å—Ç–∞—Ä—à–µ–≥–æ $31$ –±–∏—Ç–∞, –∞ –Ω–∞–º –Ω—É–∂–µ–Ω –∏–Ω–¥–µ–∫—Å —Å —Å–∞–º–æ–≥–æ –º–ª–∞–¥—à–µ–≥–æ –±–∏—Ç–∞, –ø–æ—ç—Ç–æ–º—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–µ–ª–æ–π —á–∞—Å—Ç–∏ –¥–≤–æ–∏—á–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞ —á–∏—Å–ª–∞ $i$, –Ω—É–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–µ–π —Ñ–æ—Ä–º—É–ª–æ–π:</p>
<p><code>31 - __builtin_clz(i)</code></p>
<p><strong>–ó–∞–º–µ—á–∞–Ω–∏–µ:</strong>
–ï—Å—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî —Ñ—É–Ω–∫—Ü–∏—è <code>__lg(i)</code>, –∫–æ—Ç–æ—Ä–∞—è —Å—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ü–µ–ª—É—é —á–∞—Å—Ç—å –ª–æ–≥–∞—Ä–∏—Ñ–º–∞, –æ–¥–Ω–∞–∫–æ –æ–Ω–∞ –µ—Å—Ç—å –Ω–µ –≤–æ –≤—Å–µ—Ö –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞—Ö, –ø–æ—ç—Ç–æ–º—É –±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã.</p>
<h2 id="–ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è">–ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è</h2>
<p>–ü—Ä–∏–º–µ–Ω—è—Ç—å —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –º–æ–∂–Ω–æ –∏ –ø—Ä–æ—Å—Ç–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –∫–∞–∫ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—É—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É –¥–µ—Ä–µ–≤—É –æ—Ç—Ä–µ–∑–∫–æ–≤, —Ç–∞–∫ –∏ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö. –ö –ø—Ä–∏–º–µ—Ä—É, –º–æ–∂–Ω–æ —Å–≤–µ—Å—Ç–∏ –∑–∞–¥–∞—á—É –æ –ø–æ–∏—Å–∫–µ –Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ –æ–±—â–µ–≥–æ –ø—Ä–µ–¥–∫–∞ –≤ –¥–µ—Ä–µ–≤–µ –∫ –∑–∞–¥–∞—á–µ RMQ –ø–æ –≤—ã—Å–æ—Ç–∞–º –Ω–∞ —ç–π–ª–µ—Ä–æ–≤–æ–º –æ–±—Ö–æ–¥–µ –¥–µ—Ä–µ–≤–∞.</p>
<h2 id="—Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ-—Ç–∞–±–ª–∏—Ü—ã-–¥–ª—è-–ø–æ–∏—Å–∫–∞-—Å—É–º–º—ã-–Ω–∞-–æ—Ç—Ä–µ–∑–∫–µ">–†–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—É–º–º—ã –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ</h2>
<p>–†–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ—Ç —Ñ–∞–∫—Ç, —á—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ, –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞, —Ç–æ –µ—Å—Ç—å –µ—Å–ª–∏ —É—á–µ—Å—Ç—å –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç –¥–≤–∞ —Ä–∞–∑–∞, –æ—Ç–≤–µ—Ç –Ω–µ –ø–æ–º–µ–Ω—è–µ—Ç—Å—è. –û–¥–Ω–∞–∫–æ —Ç–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∫–∞–∫ —Å—É–º–º–∞ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º–∏, –ø–æ—ç—Ç–æ–º—É –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –Ω–µ–ª—å–∑—è –∑–∞ $O(1)$ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ. –ï—Å—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü (Disjoint Sparse Table), –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑–±–∏–≤–∞–µ—Ç –ª—é–±–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –Ω–∞ –¥–≤–∞ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞.</p>
<p>–û–¥–Ω–∞–∫–æ —Å–µ–π—á–∞—Å –¥–∞–≤–∞–π—Ç–µ –ø–æ–π–º–µ–º, –∫–∞–∫ –∏—Å–∫–∞—Ç—å —Å—É–º–º—É –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –∑–∞ $O(\log n)$. –≠—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –±—É–¥–µ—Ç –ø–æ—Ö–æ–∂ –Ω–∞ –ø–æ–∏—Å–∫ –ø—Ä–µ–¥–∫–æ–≤ –≤ –¥–µ—Ä–µ–≤–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø–æ–¥—ä–µ–º–æ–≤. –î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞, –Ω–∞—á–∏–Ω–∞—é—â–µ–≥–æ—Å—è –≤ –ª–µ–≤–æ–π –≥—Ä–∞–Ω–∏—Ü–µ –æ—Ç—Ä–µ–∑–∫–∞ –∑–∞–ø—Ä–æ—Å–∞, –¥–ª–∏–Ω—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏ –∏ –±—É–¥–µ–º —É–º–µ–Ω—å—à–∞—Ç—å —Å—Ç–µ–ø–µ–Ω—å, –ø–æ–∫–∞ —Ç–µ–∫—É—â–∏–π –ø–æ–¥–æ—Ç—Ä–µ–∑–æ–∫ –Ω–µ –ø–æ–ø–∞–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–Ω—É—Ç—Ä—å –æ—Ç—Ä–µ–∑–∫–∞ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ—Å–ª–µ —á–µ–≥–æ –ø—Ä–∏–±–∞–≤–∏–º —Å—É–º–º—É –Ω–∞ —ç—Ç–æ–º –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–µ –∫ –æ—Ç–≤–µ—Ç—É –∏ –ø–µ—Ä–µ–¥–≤–∏–Ω–µ–º –ª–µ–≤—É—é –≥—Ä–∞–Ω–∏—Ü—É –≤ –∫–æ–Ω–µ—Ü —ç—Ç–æ–≥–æ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞. –î–∞–ª–µ–µ –ø—Ä–æ–¥–æ–ª–∂–∏–º –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏ –ø–æ —É–±—ã–≤–∞–Ω–∏—é. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –µ—Å–ª–∏ –Ω–∞–º –Ω–µ –ø–æ–¥–æ—à–ª–∞ –∫–∞–∫–∞—è-—Ç–æ —Å—Ç–µ–ø–µ–Ω—å –¥–≤–æ–π–∫–∏, —Ç–æ –¥–∞–ª–µ–µ –æ–Ω–∞ –Ω–∏–∫–æ–≥–¥–∞ –Ω–∞–º –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ–¥–æ–π—Ç–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –¥–ª–∏–Ω–∞ –æ—Å—Ç–∞–≤—à–µ–≥–æ—Å—è –æ—Ç—Ä–µ–∑–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è. –ë–æ–ª–µ–µ —Ç–æ–≥–æ, –Ω–∞–±–æ—Ä –≤–∑—è—Ç—ã—Ö —Å—Ç–µ–ø–µ–Ω–µ–π –¥–≤–æ–µ–∫ –≤–æ–≤—Å–µ —Å—Ç—Ä–æ–≥–æ —É–±—ã–≤–∞–µ—Ç. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –±—ã –º—ã –¥–≤–∞–∂–¥—ã –≤–∑—è–ª–∏ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∏ –¥–ª–∏–Ω—ã $2^k$, –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –≤–∑—è—Ç—å –æ–¥–∏–Ω –ø–æ–¥–æ—Ç—Ä–µ–∑–æ–∫ –¥–ª–∏–Ω—ã $2^{k + 1}$, –Ω–æ –º—ã —ç—Ç–æ–≥–æ –ø–æ—á–µ–º—É-—Ç–æ –Ω–µ —Å–¥–µ–ª–∞–ª–∏. –¢–∞–∫ —á—Ç–æ –≤–µ—Å—å –æ—Ç—Ä–µ–∑–æ–∫ –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑–æ–±—å–µ—Ç—Å—è –Ω–∞ –Ω–∞–±–æ—Ä –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–æ–≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–ª–∏–Ω. –í—Å–µ–≥–æ —Ç–∞–∫–∏—Ö –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–æ–≤ –±—É–¥–µ—Ç –Ω–µ –±–æ–ª—å—à–µ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤—Å–µ–≥–æ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–µ–ø–µ–Ω–µ–π –¥–≤–æ–µ–∫ –µ—Å—Ç—å –ª–æ–≥–∞—Ä–∏—Ñ–º.</p>
<p><strong>–ó–∞–º–µ—á–∞–Ω–∏–µ:</strong>
–ï—Å–ª–∏ –Ω–∞—á–∏–Ω–∞—Ç—å –ø–æ–∏—Å–∫ –Ω–µ —Å —Å–∞–º–æ–π –±–æ–ª—å—à–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏, –∞ —Å —Å–∞–º–æ–π –±–æ–ª—å—à–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –±–æ–ª—å—à–µ –¥–ª–∏–Ω—ã –æ—Ç—Ä–µ–∑–∫–∞ (<code>power</code> –∏–∑ –ø–æ–∏—Å–∫–∞ –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ), —Ç–æ –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç $O(\log len)$, –≥–¥–µ $len$ ‚Äî –¥–ª–∏–Ω–∞ –æ—Ç—Ä–µ–∑–∫–∞ –∑–∞–ø—Ä–æ—Å–∞, —á—Ç–æ, –∫–æ–Ω–µ—á–Ω–æ, –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ $O(\log n)$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">long</span> <span class="kt">long</span> <span class="nf">findSum</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// [l, r)
</span><span class="c1"></span>    <span class="kt">long</span> <span class="kt">long</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">power</span> <span class="o">=</span> <span class="n">logs</span><span class="p">[</span><span class="n">r</span> <span class="o">-</span> <span class="n">l</span><span class="p">];</span> <span class="n">power</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">power</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">power</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ans</span> <span class="o">+=</span> <span class="n">sparse</span><span class="p">[</span><span class="n">power</span><span class="p">][</span><span class="n">l</span><span class="p">];</span>
            <span class="n">l</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">power</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><h2 id="–º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ-—Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ-—Ç–∞–±–ª–∏—Ü—ã">–ú–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã</h2>
<p>–ë–æ–ª—å—à–∏–º –ø–ª—é—Å–æ–º —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö. –î–ª—è –ø—Ä–∏–º–µ—Ä–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –¥–≤—É–º–µ—Ä–Ω—ã–π —Å–ª—É—á–∞–π, –¥–ª—è –±'{–æ}–ª—å—à–∏—Ö —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π –≤—Å–µ –±—É–¥–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ.</p>
<p>–ï—Å–ª–∏ —Ä–∞–Ω—å—à–µ –æ—Ç—Ä–µ–∑–æ–∫ –¥–ª–∏–Ω—ã $n$ –º—ã –ø–æ–∫—Ä—ã–≤–∞–ª–∏ –¥–≤—É–º—è –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞–º–∏ –¥–ª–∏–Ω—ã $2^k$, –≥–¥–µ $2^k$ ‚Äî –±–ª–∏–∂–∞–π—à–∞—è –∫ $n$ —Å—Ç–µ–ø–µ–Ω—å –¥–≤–æ–π–∫–∏, —Ç–æ —Ç–µ–ø–µ—Ä—å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —Ä–∞–∑–º–µ—Ä–∞ $n \times m$ –º—ã –Ω–∞–∫—Ä–æ–µ–º —á–µ—Ç—ã—Ä—å–º—è –ø–æ–¥–ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞–º–∏ —Ä–∞–∑–º–µ—Ä–∞ $2^k \times 2^l$ (–±–ª–∏–∂–∞–π—à–∏–µ —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏ –∫ $n$ –∏ $m$ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ), —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –≤ —É–≥–ª–∞—Ö –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–∞. –¢–æ –µ—Å—Ç—å –º—ã –Ω–∞–∫—Ä—ã–≤–∞–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –æ—Ç—Ä–µ–∑–æ–∫ –¥–ª–∏–Ω—ã $n$ –¥–≤—É–º—è –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞–º–∏ –¥–ª–∏–Ω—ã $2^k$, –Ω–∞–∫—Ä—ã–≤–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –æ—Ç—Ä–µ–∑–æ–∫ –¥–ª–∏–Ω—ã $m$ –¥–≤—É–º—è –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞–º–∏ –¥–ª–∏–Ω—ã $2^l$, –∏ –±–µ—Ä–µ–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∏, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∏–∑ –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø–∞—Ä –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤.</p>
<p>–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–≤—É–º–µ—Ä–Ω–æ–π —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –º–æ–∂–Ω–æ —É—Å—Ç—Ä–æ–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Ä–∞–∑–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤. –ö –ø—Ä–∏–º–µ—Ä—É, –º–æ–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–µ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –æ–¥–Ω–æ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏, –∞ –∑–∞—Ç–µ–º –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –¥–≤—É–º–µ—Ä–Ω—É—é —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –Ω–∞ —ç—Ç–∏—Ö –æ–¥–Ω–æ–º–µ—Ä–Ω—ã—Ö.</p>
<p>–ó–∞–ø—Ä–æ—Å –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–µ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –æ–¥–Ω–æ–º–µ—Ä–Ω–æ–º—É —Å–ª—É—á–∞—é. –í –Ω–µ–º –º—ã –Ω–∞—Ö–æ–¥–∏–º –¥–≤–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ –æ–¥–Ω–æ–π –æ—Å–∏, –¥–≤–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ –¥—Ä—É–≥–æ–π –∏ –±–µ—Ä–µ–º –º–∏–Ω–∏–º—É–º —Å—Ä–µ–¥–∏ –ø–æ–¥–ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –≤—Å–µ–º–∏ –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ –∏—Ö –ø–∞—Ä–∞–º–∏.</p>
<p>–û—á–µ–≤–∏–¥–Ω–æ, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–∞–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±—É–¥–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å $O(n \cdot m \cdot \log n \cdot \log m)$ –≤—Ä–µ–º–µ–Ω–∏, –∞ –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å –≤—Å–µ –µ—â–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞ $O(1)$.</p>
<p>–° —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –º–æ–∂–Ω–æ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –ø–æ <a href="https://pastebin.com/1b7HWCPB">—Å—Å—ã–ª–∫–µ</a>.</p>
<h2 id="–∑–∞–¥–∞—á–∏-–¥–ª—è-–ø—Ä–∞–∫—Ç–∏–∫–∏">–ó–∞–¥–∞—á–∏ –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
<ul>
<li>
<p><a href="https://informatics.msk.ru/mod/statements/view.php?id=597#1">–ó–∞–¥–∞—á–∞</a> –Ω–∞ –ø–æ–∏—Å–∫ –º–∞–∫—Å–∏–º—É–º–∞ –∏ –∏–Ω–¥–µ–∫—Å–∞ —ç—Ç–æ–≥–æ –º–∞–∫—Å–∏–º—É–º–∞ –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ.</p>
</li>
<li>
<p>–ó–∞–¥–∞—á—É E <a href="https://codeforces.com/gym/100093">—ç—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ—Å—Ç–∞</a> —Å–ª–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —á–µ–º-—Ç–æ –∫—Ä–æ–º–µ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü.</p>
</li>
<li>
<p>–ó–∞–¥–∞—á–∏ –Ω–∞ Disjoint Sparse Table –º–æ–∂–Ω–æ –ø—Ä–æ—Ä–µ—à–∞—Ç—å –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–º <a href="https://codeforces.com/group/1rv4rhCsHp/contest/102954">–∫–æ–Ω—Ç–µ—Å—Ç–µ</a> –Ω–∞ codeforces.</p>
</li>
</ul>

        
      </div>
      <div class="paginator">
        
        <a class="link" href="https://peltorator.ru/try_web/post/prefix_sums/">‚Üê prev</a>
        
        
        <a class="link" href="https://peltorator.ru/try_web/post/down_segment_tree/">next ‚Üí</a>
        
      </div>
      <div class="comment">
        
        
        
        
      </div>
      
    </main>
    <footer id="footer">
  <div>
    <span>¬© 2021</span> - <span>2021</span>
  </div>

  <div>
    <span>Powered by </span>
    <a class="link" href="https://gohugo.io/">Hugo</a>
    <span> üç¶ Theme </span>
    <a class="link" href="https://github.com/queensferryme/hugo-theme-texify">TeXify</a>
  </div>

  <div class="footnote">
    <span></span>
  </div>
</footer>

  </div>
  





</body>

</html>
