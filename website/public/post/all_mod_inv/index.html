<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">


<meta name="author" content="peltorator">



<meta name="description" content="–ß–∞—Å—Ç–æ –±—ã–≤–∞–µ—Ç —Ç–∞–∫, —á—Ç–æ –≤ –∑–∞–¥–∞—á–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∏—Ç—å –ø–æ –º–æ–¥—É–ª—é –º–Ω–æ–≥–æ —Ä–∞–∑. –≠—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –æ–±—ã—á–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º –≤–∑—è—Ç–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø–æ –º–æ–¥—É–ª—é –∑–∞ $O(\log p)$ –Ω–∞ –∑–∞–ø—Ä–æ—Å. –ï—Å–ª–∏ –º—ã —Å–¥–µ–ª–∞–µ–º $n$ –∑–∞–ø—Ä–æ—Å–æ–≤, —Ç–æ –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ –±—É–¥–µ—Ç $O(n \log p)$. –°–µ–π—á–∞—Å –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–µ –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞—Ç–∫–∞–º –∑–∞ $O(p)$, –∏ —Ç–æ–≥–¥–∞ –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –º—ã –±—É–¥–µ–º –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ $O(1)$. –ï—Å–ª–∏ $n$ –ø–æ—Ä—è–¥–∫–∞ $p$ –∏–ª–∏ –±–æ–ª—å—à–µ, —Ç–æ —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –±—É–¥–µ—Ç –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω.">



<link rel="icon" href="/favicon.ico">



<meta name="keywords" content=" hugo  latex  theme ">




<script>
  
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true,
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    }
  };
</script>

<script async defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>



<script src="https://tikzjax.com/v1/tikzjax.js"></script>
<script src="https://tikzwolke.com/v1/tikzwolke.js"></script>


<link rel="canonical" href="https://peltorator.ru/try_web/post/all_mod_inv/">




<title>–ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω—ã—Ö –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞—Ç–∫–∞–º –∑–∞ $O(p)$ - peltorator</title>



<link media="screen" rel="stylesheet" href='https://peltorator.ru/try_web/css/common.css'>
<link media="screen" rel="stylesheet" href='https://peltorator.ru/try_web/css/content.css'>
<link media="screen" rel="stylesheet" href='https://peltorator.ru/try_web/css/highlight.css'>


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="–ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω—ã—Ö –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞—Ç–∫–∞–º –∑–∞ $O(p)$" />
<meta name="twitter:description" content="–ß–∞—Å—Ç–æ –±—ã–≤–∞–µ—Ç —Ç–∞–∫, —á—Ç–æ –≤ –∑–∞–¥–∞—á–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∏—Ç—å –ø–æ –º–æ–¥—É–ª—é –º–Ω–æ–≥–æ —Ä–∞–∑. –≠—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –æ–±—ã—á–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º –≤–∑—è—Ç–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø–æ –º–æ–¥—É–ª—é –∑–∞ $O(\log p)$ –Ω–∞ –∑–∞–ø—Ä–æ—Å. –ï—Å–ª–∏ –º—ã —Å–¥–µ–ª–∞–µ–º $n$ –∑–∞–ø—Ä–æ—Å–æ–≤, —Ç–æ –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ –±—É–¥–µ—Ç $O(n \log p)$. –°–µ–π—á–∞—Å –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–µ –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞—Ç–∫–∞–º –∑–∞ $O(p)$, –∏ —Ç–æ–≥–¥–∞ –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –º—ã –±—É–¥–µ–º –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ $O(1)$. –ï—Å–ª–∏ $n$ –ø–æ—Ä—è–¥–∫–∞ $p$ –∏–ª–∏ –±–æ–ª—å—à–µ, —Ç–æ —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –±—É–¥–µ—Ç –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω." />


  <link rel="stylesheet" href='https://peltorator.ru/try_web/css/single.css'>
</head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1>
    <a href="https://peltorator.ru/try_web/">peltorator</a>
  </h1>

  <nav>
    
  </nav>
</header>

    <main id="main" class="post">
      
      
      
      <h1>–ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω—ã—Ö –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞—Ç–∫–∞–º –∑–∞ $O(p)$</h1>
      
      <div class="content">
        
        <p>–ß–∞—Å—Ç–æ –±—ã–≤–∞–µ—Ç —Ç–∞–∫, —á—Ç–æ –≤ –∑–∞–¥–∞—á–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∏—Ç—å –ø–æ –º–æ–¥—É–ª—é –º–Ω–æ–≥–æ —Ä–∞–∑. –≠—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –æ–±—ã—á–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º –≤–∑—è—Ç–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø–æ –º–æ–¥—É–ª—é –∑–∞ $O(\log p)$ –Ω–∞ –∑–∞–ø—Ä–æ—Å. –ï—Å–ª–∏ –º—ã —Å–¥–µ–ª–∞–µ–º $n$ –∑–∞–ø—Ä–æ—Å–æ–≤, —Ç–æ –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ –±—É–¥–µ—Ç $O(n \log p)$. –°–µ–π—á–∞—Å –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—Ä–µ–¥–ø–æ—Å—á–∏—Ç–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–µ –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞—Ç–∫–∞–º –∑–∞ $O(p)$, –∏ —Ç–æ–≥–¥–∞ –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –º—ã –±—É–¥–µ–º –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ $O(1)$. –ï—Å–ª–∏ $n$ –ø–æ—Ä—è–¥–∫–∞ $p$ –∏–ª–∏ –±–æ–ª—å—à–µ, —Ç–æ —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –±—É–¥–µ—Ç –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω.</p>
<p>–ï—Å—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é—Ç —ç—Ç–æ. –ó–¥–µ—Å—å –±—É–¥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –¥–≤–∞, –ø–æ–∂–∞–ª—É–π, —Å–∞–º—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö: –æ–¥–∏–Ω –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ –∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏, –∞ –¥—Ä—É–≥–æ–π –µ—â–µ –ª–µ–≥—á–µ –≤ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏, –æ–¥–Ω–∞–∫–æ –Ω–µ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –æ—á–µ–≤–∏–¥–Ω—ã–π —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏ –ø—Ä–∏–¥—É–º—ã–≤–∞–Ω–∏—è.</p>
<h2 id="–º–µ—Ç–æ–¥-–æ–±—Ä–∞—Ç–Ω—ã—Ö-—Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–æ–≤">–ú–µ—Ç–æ–¥ –æ–±—Ä–∞—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–æ–≤</h2>
<p>–ò–¥–µ—è –ø–µ—Ä–≤–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –º—ã –ø–æ—Å—á–∏—Ç–∞–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã –∏ –æ–±—Ä–∞—Ç–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã, –∞ –ª—é–±–æ–µ –æ–±—Ä–∞—Ç–Ω–æ–µ –∫ –∫–∞–∫–æ–º—É-—Ç–æ –æ—Å—Ç–∞—Ç–∫—É –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º –∫–∞–∫ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–≤—É—Ö —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–æ–≤.</p>
<p><strong>–¢–µ–æ—Ä–µ–º–∞:</strong>
–¢–µ–æ—Ä–µ–º–∞ –í–∏–ª—å—Å–æ–Ω–∞ –≥–ª–∞—Å–∏—Ç, —á—Ç–æ –µ—Å–ª–∏ $p$ ‚Äî –ø—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ, —Ç–æ</p>
<p>$$
(p - 1)! \equiv -1 \pmod p
$$</p>
<p><strong>–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:</strong></p>
<p>–î–∞–≤–∞–π—Ç–µ –∑–∞–º–µ—Ç–∏–º, —á—Ç–æ –≤—Å–µ –æ—Å—Ç–∞—Ç–∫–∏ –æ—Ç $1$ –¥–æ $p - 1$ —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ –ø–∞—Ä—ã –≤–∏–¥–∞ $x$, $x^{-1}$. –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —á–∏—Å–µ–ª –≤ –ø–∞—Ä–µ —Ä–∞–≤–Ω–æ –µ–¥–∏–Ω–∏—Ü–µ –ø–æ –º–æ–¥—É–ª—é $p$.
–ï—Å—Ç—å –æ–¥–∏–Ω –∫—Ä–∞–π–Ω–∏–π —Å–ª—É—á–∞–π: –∫–æ–≥–¥–∞ $x = x^{-1}$. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ $x^2 \equiv 1 \pmod p$, —Ç–æ –µ—Å—Ç—å
$x^2 - 1 = (x - 1) \cdot (x + 1)\  ‚ãÆ\ p$. –ó–Ω–∞—á–∏—Ç, $x \equiv \pm 1 \pmod p$. –¢–æ–≥–¥–∞ –≤ –∏—Ç–æ–≥–µ $(p - 1)!$ –ø–æ –º–æ–¥—É–ª—é $p$ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –µ–¥–∏–Ω–∏—Ü, –∞ —Ç–∞–∫–∂–µ –æ–¥–Ω–æ–π $-1$. –¢–∞–∫ —á—Ç–æ $(p - 1)! \equiv -1 \pmod p$. –ß—Ç–æ –∏ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –¥–æ–∫–∞–∑–∞—Ç—å.</p>
<p>–ó–Ω–∞—è —ç—Ç–æ—Ç —Ñ–∞–∫—Ç, –º—ã –º–æ–∂–µ–º —Å—Ä–∞–∑—É –ø–æ–Ω—è—Ç—å, —á—Ç–æ $\left((p - 1)!\right)^{-1} \equiv -1 \pmod p$, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–±—Ä–∞—Ç–Ω–æ–µ –∫ $-1$ ‚Äî —ç—Ç–æ $-1$. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–±—Ä–∞—Ç–Ω–æ–µ –∫ $(p - 1)!$ –º—ã —É–∂–µ –ø–æ—Å—á–∏—Ç–∞–ª–∏.</p>
<p><strong>–ó–∞–º–µ—á–∞–Ω–∏–µ:</strong>
–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –±—ã–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç—Ç–æ–π —Ñ–æ—Ä–º—É–ª–æ–π. –ú–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∑–∞ $O(p)$ —á–∏—Å–ª–æ $(p - 1)!$, –∞ –ø–æ—Ç–æ–º –±–∏–Ω–∞—Ä–Ω—ã–º –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ–º –≤ —Å—Ç–µ–ø–µ–Ω—å –Ω–∞–π—Ç–∏ –∫ –Ω–µ–º—É –æ–±—Ä–∞—Ç–Ω–æ–µ –∑–∞ $O(\log p)$. –ò—Ç–æ–≥–æ–≤–∞—è –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∞ –±—ã –æ—Ç —ç—Ç–æ–≥–æ –Ω–µ –ø–æ—Å—Ç—Ä–∞–¥–∞–ª–∞.</p>
<p>–ú—ã —É–∂–µ –Ω–∞—à–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ–µ –∫ $(p - 1)!$. –ö–∞–∫ –∂–µ –Ω–∞–π—Ç–∏ –æ–±—Ä–∞—Ç–Ω–æ–µ –∫ $(p - 2)!$ —Ç–µ–ø–µ—Ä—å?
–ó–∞–º–µ—Ç–∏–º —Å–ª–µ–¥—É—é—â–∏–π —Ñ–∞–∫—Ç:</p>
<p>$$
\frac{1}{k!} = \frac{k + 1}{(k + 1)!}
$$</p>
<p>–¢–∞–∫ —á—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –≤—Å–µ—Ö –æ–±—Ä–∞—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–æ–≤ —Å–ª–µ–¥—É—é—â–∏–π: –∏–¥–µ–º —Å –∫–æ–Ω—Ü–∞, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º, —á—Ç–æ –æ–±—Ä–∞—Ç–Ω–æ–µ –∫ $(p - 1)!$ ‚Äî —ç—Ç–æ $-1$, –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–æ –æ—á–µ—Ä–µ–¥–∏ –æ–±—Ä–∞—Ç–Ω–æ–µ –∫ $k!$ –∫–∞–∫ –æ–±—Ä–∞—Ç–Ω–æ–µ –∫ $(k + 1)!$, —É–º–Ω–æ–∂–µ–Ω–Ω–æ–µ –Ω–∞ $k + 1$.</p>
<p>–¢–µ–ø–µ—Ä—å –ø—É—Å—Ç—å –º—ã –ø–æ—Å—á–∏—Ç–∞–ª–∏ –≤—Å–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã –∏ –≤—Å–µ –æ–±—Ä–∞—Ç–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã –∑–∞ $O(p)$. –ö–∞–∫ –Ω–∞–π—Ç–∏ –æ–±—Ä–∞—Ç–Ω—ã–µ –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞—Ç–∫–∞–º? –° —ç—Ç–∏–º –Ω–∞–º –ø–æ–º–æ–∂–µ—Ç —Å–ª–µ–¥—É—é—â–∞—è —Ñ–æ—Ä–º—É–ª–∞:</p>
<p>$$
\frac{1}{k} = \frac{(k - 1)!}{k!}
$$</p>
<p>–ê –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–≤—É—Ö —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–æ–≤ ‚Äî —ç—Ç–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–∞ –Ω–∞ –æ–±—Ä–∞—Ç–Ω–æ–µ –∫–æ –≤—Ç–æ—Ä–æ–º—É.</p>
<p>–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º –∫–æ–¥ –∞–ª–≥–æ—Ä–∏—Ç–º–∞:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">getAllModularInverses</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">inverseFactorials</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="n">inverseFactorials</span><span class="p">[</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// -1 mod p = p - 1
</span><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">inverseFactorials</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1LL</span> <span class="o">*</span> <span class="n">inverseFactorials</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">inverses</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">factorial</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">inverses</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1LL</span> <span class="o">*</span> <span class="n">factorial</span> <span class="o">*</span> <span class="n">inverseFactorials</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
        <span class="n">factorial</span> <span class="o">=</span> <span class="mi">1LL</span> <span class="o">*</span> <span class="n">factorial</span> <span class="o">*</span> <span class="n">k</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">inverses</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>–í–µ—Å—å –∞–ª–≥–æ—Ä–∏—Ç–º ‚Äî —ç—Ç–æ –¥–≤–∞ –ø—Ä–æ—Ö–æ–¥–∞ –ø–æ —á–∏—Å–ª–∞–º –æ—Ç $1$ –¥–æ $p - 1$, —Ç–∞–∫ —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–Ω –∑–∞ $O(p)$.
–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ —Ç–æ–∂–µ $O(p)$, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –º–∞—Å—Å–∏–≤—ã —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–æ–≤ –∏ –æ–±—Ä–∞—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–æ–≤.
–û—Ç –æ–¥–Ω–æ–≥–æ –∏–∑ –Ω–∏—Ö –º–æ–∂–Ω–æ –∏–∑–±–∞–≤–∏—Ç—å—Å—è, –µ—Å–ª–∏ –≤—ã—á–∏—Å–ª—è—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –ª–µ—Ç—É (–≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –∫–æ–¥–µ –º—ã –Ω–µ —Ö—Ä–∞–Ω–∏–ª–∏ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã), –æ–¥–Ω–∞–∫–æ –Ω–µ –æ—Ç –æ–±–æ–∏—Ö.</p>
<p><strong>–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:</strong>
–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏—é —ç—Ç–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $O(p)$, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç $O(\sqrt{p})$ –ø–∞–º—è—Ç–∏ (—Å—á–∏—Ç–∞–π—Ç–µ, —á—Ç–æ –æ—Ç–≤–µ—Ç—ã ‚Äî –≤–µ–∫—Ç–æ—Ä <code>inverses</code> ‚Äî –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –≤—ã–≤–æ–¥–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω, –∏ –≤–∞–º –Ω–µ –Ω—É–∂–Ω–æ –∏—Ö —Ö—Ä–∞–Ω–∏—Ç—å).</p>
<p><strong>–ó–∞–º–µ—á–∞–Ω–∏–µ:</strong>
–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã, –Ω–∞—á–∏–Ω–∞—è –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å $p - 1$. –ï—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –æ–±—Ä–∞—Ç–Ω—ã–µ –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞—Ç–∫–∞–º –æ—Ç $1$ –¥–æ $n$, —Ç–æ –º–æ–∂–Ω–æ –∑–∞ $O(n)$ –ø–æ—Å—á–∏—Ç–∞—Ç—å $n! \bmod p$, –Ω–∞–π—Ç–∏ –∫ –Ω–µ–º—É –æ–±—Ä–∞—Ç–Ω–æ–µ –∑–∞ $O(\log p)$ –∏ –ø–æ—Ç–æ–º –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º—É –≤—ã—à–µ —Å–ø–æ—Å–æ–±—É –Ω–∞—Å—á–∏—Ç–∞—Ç—å –≤—Å–µ –æ–±—Ä–∞—Ç–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª—ã –æ—Ç $1$ –¥–æ $n$. –¢–æ–≥–¥–∞ –ø–æ–¥—Å—á–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã—Ö –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞—Ç–∫–∞–º –æ—Ç $1$ –¥–æ $n$ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞ $O(n + \log p)$.</p>
<p>–ö–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å, –∞–ª–≥–æ—Ä–∏—Ç–º –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π. –û–¥–Ω–∞–∫–æ –µ–≥–æ —Ä–µ–¥–∫–æ –ø–æ–ª—É—á–∏—Ç—Å—è –≥–¥–µ-—Ç–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å, –ø–æ—Ç–æ–º—É —á—Ç–æ, –≤–æ-–ø–µ—Ä–≤—ã—Ö, –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–±—Ä–∞—Ç–Ω—ã—Ö –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ $O(p \log p)$, —á—Ç–æ —Ç—è–∂–µ–ª–æ –æ—Ç—Å–µ—á—å –æ—Ç $O(p)$ –Ω–∞ –Ω–µ—É—á–µ–±–Ω–æ–π –∑–∞–¥–∞—á–µ,
–∞ –≤–æ-–≤—Ç–æ—Ä—ã—Ö, –º–æ–¥—É–ª—å —á–∞—â–µ –≤—Å–µ–≥–æ ‚Äî —ç—Ç–æ —á–∏—Å–ª–æ –ø–æ—Ä—è–¥–∫–∞ $10^9$, –ø–æ—ç—Ç–æ–º—É –≤—ã –Ω–µ –∏–º–µ–µ—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ—Å—á–∏—Ç–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–µ –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞—Ç–∫–∞–º, –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∑–∞ $O(n \log p)$ –¥–∞–µ—Ç –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.</p>
<h2 id="–∞–ª–≥–æ—Ä–∏—Ç–º-–æ–¥–Ω–æ–≥–æ-—Ü–∏–∫–ª–∞">–ê–ª–≥–æ—Ä–∏—Ç–º –æ–¥–Ω–æ–≥–æ —Ü–∏–∫–ª–∞</h2>
<p>–í—Ç–æ—Ä–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–∏—à–µ—Ç—Å—è –≤—Å–µ–≥–æ –æ–¥–Ω–∏–º —Ü–∏–∫–ª–æ–º. –û–¥–Ω–∞–∫–æ —á—Ç–æ–±—ã –µ–≥–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å, –ø—Ä–∏–¥–µ—Ç—Å—è –Ω–∞–ø–∏—Å–∞—Ç—å –ø–∞—Ä—É —Ñ–æ—Ä–º—É–ª –Ω–∞ –±—É–º–∞–∂–∫–µ.</p>
<p>–ê–ª–≥–æ—Ä–∏—Ç–º –æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ–¥–Ω–æ–º –ø—Ä–æ—Å—Ç–æ–º —Ñ–∞–∫—Ç–µ:</p>
<p><strong>–¢–µ–æ—Ä–µ–º–∞:</strong>
$$
\frac{1}{k} \equiv -\left\lfloor \frac{p}{k} \right\rfloor \cdot \frac{1}{p \bmod k} \pmod p
$$</p>
<p><strong>–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:</strong>
–î–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º $p$ –≤ –≤–∏–¥–µ $k \cdot x + y$, –≥–¥–µ $x = \left\lfloor \frac{p}{k} \right\rfloor$ –∏ $y = p \bmod k$.</p>
<p>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ</p>
<p>$$k \cdot \left(-\left\lfloor \frac{p}{k} \right\rfloor \cdot \frac{1}{p \bmod k} \right) \equiv 1 \pmod p$$</p>
<p>$$
k \cdot (-x \cdot \frac{1}{y}) = - (k \cdot x) \cdot \frac{1}{y} = - \left((k \cdot x + y) - y\right) \cdot \frac{1}{y} = - (p - y) \cdot \frac{1}{y} \equiv y \cdot \frac{1}{y} \equiv 1 \pmod p
$$</p>
<p>–ß—Ç–æ –∏ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –¥–æ–∫–∞–∑–∞—Ç—å.</p>
<p>–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º –ø–æ—Å—á–∏—Ç–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ–µ –∫ $k$, –µ—Å–ª–∏ —É–∂–µ –ø–æ—Å—á–∏—Ç–∞–Ω–æ –æ–±—Ä–∞—Ç–Ω–æ–µ –∫ $p \bmod k$. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —ç—Ç–æ —á–∏—Å–ª–æ –º–µ–Ω—å—à–µ, —á–µ–º $k$,
–ø–æ—ç—Ç–æ–º—É –≤—Å–µ –æ–±—Ä–∞—Ç–Ω—ã–µ –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª—è—Ç—å –ø–æ –ø–æ—Ä—è–¥–∫—É.</p>
<p>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É —ç—Ç–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∫—Ä–∞–π–Ω–µ –ø—Ä–æ—Å—Ç–∞:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">getAllModularInverses</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">inverses</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="n">inverses</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">inverses</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1LL</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">inverses</span><span class="p">[</span><span class="n">p</span> <span class="o">%</span> <span class="n">k</span><span class="p">]</span> <span class="o">%</span> <span class="n">p</span> <span class="o">+</span> <span class="n">p</span><span class="p">;</span>
        <span class="c1">// +p because this number is negative
</span><span class="c1"></span>    <span class="p">}</span>
    <span class="k">return</span> <span class="n">inverses</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>–¢–∞–∫–∂–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ–º —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –æ–¥–∏–Ω —Ü–∏–∫–ª <code>for</code> –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é, –ø–æ—ç—Ç–æ–º—É –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–µ –Ω–µ –∫–æ –≤—Å–µ–º –æ—Å—Ç–∞—Ç–∫–∞–º, –∞ –∫ –ø–µ—Ä–≤—ã–º $n$ –æ—Å—Ç–∞—Ç–∫–∞–º –∑–∞ $O(n)$ –æ—á–µ–Ω—å –ª–µ–≥–∫–æ. –û–¥–Ω–∞–∫–æ –Ω–µ –æ—á–µ–Ω—å —è—Å–Ω–æ, –¥–ª—è —á–µ–≥–æ —ç—Ç–æ –º–æ–∂–µ—Ç –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è.</p>
<p>–ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–∞ $p$ –ø–æ—Ä—è–¥–∫–∞ $10^8$ –≤—Ç–æ—Ä–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ –¥–≤–∞ —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –ø–µ—Ä–≤—ã–π.</p>

        
      </div>
      <div class="paginator">
        
        <a class="link" href="https://peltorator.ru/try_web/post/persistent_cht/">‚Üê prev</a>
        
        
        <a class="link" href="https://peltorator.ru/try_web/post/mod_factorial/">next ‚Üí</a>
        
      </div>
      <div class="comment">
        
        
        
        
      </div>
      
    </main>
    <footer id="footer">
  <div>
    <span>¬© 2021</span> - <span>2021</span>
  </div>

  <div>
    <span>Powered by </span>
    <a class="link" href="https://gohugo.io/">Hugo</a>
    <span> üç¶ Theme </span>
    <a class="link" href="https://github.com/queensferryme/hugo-theme-texify">TeXify</a>
  </div>

  <div class="footnote">
    <span></span>
  </div>
</footer>

  </div>
  





</body>

</html>
